
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Classical Random Walk on a Quantum Computer &#8212; NordIQuEst Application Library</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx_lesson.css?v=0c089442" />
    <link rel="stylesheet" type="text/css" href="../../_static/term_role_formatting.css?v=4194e21c" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/minipres.js?v=a0d29692"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'hybrid-algorithms/Quantum Walk/ClassicalRandomWalk';</script>
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Quantum Random Walk on a Quantum Computer" href="QuantumRandomWalk.html" />
    <link rel="prev" title="Quantum Walk" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/nq_logo2.png" class="logo__image only-light" alt="NordIQuEst Application Library - Home"/>
    <script>document.write(`<img src="../../_static/nq_logo2.png" class="logo__image only-dark" alt="NordIQuEst Application Library - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Application Library</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../README.html"><strong>NordIQuEst Application Library</strong></a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html"><strong>Hybrid Algorithms</strong></a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../QAOA/index.html">Quantum Approximate Optimization Algorithm (QAOA)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../QAOA/MaxCut.html">MaxCut QAOA</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Quantum%20Chemistry/index.html">Quantum Chemistry</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Quantum%20Chemistry/Installation.html">Installation instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Quantum%20Chemistry/Theory.html">Theory: Quantum Chemistry on Quantum Computers</a></li>

<li class="toctree-l3"><a class="reference internal" href="../Quantum%20Chemistry/VQE.html">Notebook example: VQE</a></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="index.html">Quantum Walk</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Classical Random Walk on a Quantum Computer</a></li>
<li class="toctree-l3"><a class="reference internal" href="QuantumRandomWalk.html">Quantum Random Walk on a Quantum Computer</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../VQE/index.html">Variational Quantum Eigensolver (VQE) Tutorial</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../VQE/vqe-h2-cirq.html">Cirq: Variational Quantum Eigensolver for <span class="math notranslate nohighlight">\(H_2\)</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="../VQE/vqe-h2-qiskit.html">Qiskit: Variational Quantum Eigensolver for <span class="math notranslate nohighlight">\(H_2\)</span></a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../real-devices/index.html"><strong>Real Devices</strong></a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../real-devices/ex3-qal9000-demo/index.html">ex3-qal9000 Demo</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../real-devices/ex3-qal9000-demo/compute-bloch-frames.html">ex3-qal9000 Demo: StateTomography on QAL9000</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../real-devices/intro-to-helmi-qiskit.html">Introduction to Helmi with Qiskit</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../simulators/index.html"><strong>Simulators</strong></a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../simulators/ex3/index.html">ex3 Simulators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../simulators/ex3/qiskit/README.html">Running Quantum programs on the Qiskit Simulator in eX3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../simulators/ex3/qsim/README.html">QSIM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../simulators/ex3/QuEST/README.html">Guide of Running QuEST in eX3</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../simulators/lumi/index.html">LUMI Simulators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../training-material/index.html"><strong>Training Material Archive</strong></a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../training-material/qas2022/index.html">Quantum Autumn School 2022</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../training-material/qas2022/notebooks/index.html">Notebooks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2022/notebooks/E1_qc-1.html"><strong>Quantum programming I</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2022/notebooks/E1_qc-2.html"><strong>Quantum programming II</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2022/notebooks/E1_qc-3.html"><strong>Quantum programming III</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2022/notebooks/E2_optimization.html"><strong>Use case: Optimization</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2022/notebooks/E2_VQE-H2.html"><strong>Use case: Quantum chemistry</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2022/notebooks/quito.html">Quantum software testing with Quito</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../training-material/qas2022/slides/index.html">Slides</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2022/slides/landscape.html">The HPC-QC landscape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2022/slides/qc_hardware.html">Overview of different QC hardware approaches and QC types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2022/slides/programming_qc.html">Introduction to high-level languages for QC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2022/slides/hybrid_hpc_qc.html">The hybrid HPC-QC approach</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2022/slides/software_stack_overview.html">Overview of the software stack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2022/slides/hybrid_algorithms.html">Hybrid classical/quantum algorithms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2022/slides/qc_testing.html">Quantum software testing</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../training-material/qas2023/index.html">Quantum Autumn School 2023</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../training-material/qas2023/notebooks/index.html">Notebooks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2023/notebooks/E2_VQE-H2.html">Tutorial - Quantum chemistry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2023/notebooks/intro-to-helmi-qiskit.html">Tutorial - Introduction to Helmi with qiskit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2023/notebooks/Notebook_maxcut_Qas2023.html">Tutorial - Quantum Alternating Operator Ansatz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2023/notebooks/Notebook_maxcut_Qas2023_sol.html">Solutions - Tutorial - Quantum Alternating Operator Ansatz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2023/notebooks/Qubit_Spectroscopy_Analysis.html">Tutorial - Qubit Spectroscopy Analysis</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../training-material/qas2023/slides/index.html">Slides</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2023/slides/hpc-qc.html">HPC-QC integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2023/slides/software-stack.html">QC software stack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../training-material/qas2023/slides/hybrid-classical-quantum.html">Hybrid Classical/Quantum Algorithms</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Information</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../docs/authors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/acknowledgement.html">Acknowledgement</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/NordIQuEst/application-library" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/hybrid-algorithms/Quantum Walk/ClassicalRandomWalk.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Classical Random Walk on a Quantum Computer</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#in-our-setting-we-consider-a-typical-classical-1-d-random-walk-setting-consisting-of">In our setting we consider a typical classical 1-D random walk setting, consisting of:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#can-we-use-a-quantum-computer-to-evolve-a-lot-of-these-experiments-simultaneously">Can we use a quantum computer to evolve a lot of these experiments simultaneously?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encode-the-starting-position-in-a-quantum-circuit">1) Encode the starting position in a quantum circuit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-coin-flip-circuit">2) Create a coin-flip circuit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-add-and-sub-gates">3) Create add and sub gates</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-gate">Add gate</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sub-gate">Sub gate</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apply-the-gates-to-the-position-circuit-conditioned-to-the-coin-flip-for-steps-number-of-times">4) Apply the gates to the position circuit, conditioned to the coin-flip, for steps number of times</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#put-the-circuit-together-run-experiments-and-show-the-final-distribution">5) Put the circuit together, run experiments and show the final distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#improving-the-circuit-with-qft">6) Improving the circuit with QFT</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="classical-random-walk-on-a-quantum-computer">
<h1>Classical Random Walk on a Quantum Computer<a class="headerlink" href="#classical-random-walk-on-a-quantum-computer" title="Link to this heading">#</a></h1>
<p>Author: Costantino Carugno (VTT)</p>
<section id="in-our-setting-we-consider-a-typical-classical-1-d-random-walk-setting-consisting-of">
<h2>In our setting we consider a typical classical 1-D random walk setting, consisting of:<a class="headerlink" href="#in-our-setting-we-consider-a-typical-classical-1-d-random-walk-setting-consisting-of" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>n = starting position. We restrict to positive integer values.</p></li>
<li><p>p = probability of walking up / down the integer line.</p></li>
<li><p>steps = integer time steps that we allow the system evolve.</p></li>
</ul>
</section>
<section id="can-we-use-a-quantum-computer-to-evolve-a-lot-of-these-experiments-simultaneously">
<h2>Can we use a quantum computer to evolve a lot of these experiments simultaneously?<a class="headerlink" href="#can-we-use-a-quantum-computer-to-evolve-a-lot-of-these-experiments-simultaneously" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Encode the starting position in a quantum circuit</p></li>
<li><p>Create a coin-flip circuit</p></li>
<li><p>Create add and sub gates</p></li>
<li><p>Apply the gates to the position circuit, conditioned to the coin-flip,  for steps number of times</p></li>
<li><p>Put the circuit together, run experiments and show the final distribution</p></li>
<li><p>Improving the circuit with QFT</p></li>
</ol>
</section>
<section id="encode-the-starting-position-in-a-quantum-circuit">
<h2>1) Encode the starting position in a quantum circuit<a class="headerlink" href="#encode-the-starting-position-in-a-quantum-circuit" title="Link to this heading">#</a></h2>
<p>Convert the number to binary and use “binary encoding” to set up an initial state of a quantum register. This step is easily accomplished by starting in all-‘0’s state and applying X gates to the ‘1’ bits. We will use the little endian convention (least significant digit stored in the first qubit).</p>
<p>Note that for circuit of this size the number of time steps cannot be greater than n itself, as the quantum register would not be large enough. In order to mitigate this behavior one can create a larger register, for example using the double flag already provided.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">ClassicalRegister</span><span class="p">,</span> <span class="n">QuantumCircuit</span><span class="p">,</span> <span class="n">QuantumRegister</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit.library</span> <span class="kn">import</span> <span class="n">QFT</span>
<span class="kn">from</span> <span class="nn">qiskit_aer</span> <span class="kn">import</span> <span class="n">AerSimulator</span><span class="p">,</span> <span class="n">QasmSimulator</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">encode_basis</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">double</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">num_qubits</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">double</span><span class="p">:</span>
        <span class="n">num_qubits</span> <span class="o">*=</span> <span class="mi">2</span>
        <span class="n">num_qubits</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="n">qnum</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="n">num_qubits</span><span class="p">,</span> <span class="s2">&quot;q_num&quot;</span><span class="p">)</span>

    <span class="n">circuit</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">qnum</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_qubits</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">circuit</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">qnum</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">circuit</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">11</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The number </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> in binary is: </span><span class="si">{</span><span class="nb">bin</span><span class="p">(</span><span class="n">n</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The quantum circuit for </span><span class="si">{</span><span class="nb">bin</span><span class="p">(</span><span class="n">n</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="si">}</span><span class="s2"> is (read bottom to top):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">encode_basis</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-a-coin-flip-circuit">
<h2>2) Create a coin-flip circuit<a class="headerlink" href="#create-a-coin-flip-circuit" title="Link to this heading">#</a></h2>
<p>In order to decide whether to move up or down we need to flip a coin, at each time step.
A quantum coin is easily implemented by using an ‘H’ gate, which puts a qubit in a |0⟩ and |1⟩ in superposition, and can be used to make a decision, add or subtract.</p>
<p>You can bias the coin by setting the bias parameter (set to equal probability by default). A value closer to 0 increases the probability of |0⟩, while a value closer to 1 favors the |1⟩ state.</p>
<p><strong>Research Question: Why is it more appropriate to use ry instead of rx?</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">qcoin</span><span class="p">(</span><span class="n">bias</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">bias</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">bias</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Bias should be between 0 and 1&quot;</span><span class="p">)</span>

    <span class="n">qcoin_reg</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">qcoin_reg</span><span class="p">)</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">bias</span><span class="p">)</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">ry</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">qc</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">qcoin</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-add-and-sub-gates">
<h2>3) Create add and sub gates<a class="headerlink" href="#create-add-and-sub-gates" title="Link to this heading">#</a></h2>
<section id="add-gate">
<h3>Add gate<a class="headerlink" href="#add-gate" title="Link to this heading">#</a></h3>
<p>An add gate increments by one the number encoded. In practice we need to sum ‘1’ to least significant qubit. This is not a problem if the least significant qubit is currently ‘0’. However if it is already a ‘1’ we need to carry on the operation onto the second-to-least significant qubit, and set the least significant qubit back to ‘0’. If otherwise also the second-to-least significant qubit is set to ‘1’… the carry goes on. The worst scenario can escalate to the entire register.</p>
<p>The add gate is thus implemented with multi-controlled-X gates, arranged in a ladder, so that the first mcx controls all the digits, the second controls n-1 digits and so on, making sure that only the proper qubits are flipped.</p>
<p>If a value more than ‘1’ needs to be added, one can use the “value” parameter. The effect of the inner for loop is to add 1 to the quantum register. Since the outer loop runs “value” times, the quantum register is incremented by “value”.</p>
<p>Note that these type of gates are often very difficult to implement in real-hardware, as multi-qubit connections can be difficult to implement with high fidelity.</p>
<p>In our implementation the last qubit (on the bottom) should not be part of the gate, but it is needed to control the quantum coin.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_gate</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">add</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;add&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)):</span>
            <span class="n">add</span><span class="o">.</span><span class="n">mcx</span><span class="p">([</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="p">[</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">)]],</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">add</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">add</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">add</span><span class="o">.</span><span class="n">to_instruction</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>A self-contained example clarifies the use of the function.</p>
<p>We will encode ‘5’ and use add_gate to sum ‘2’ obtaining 5+2=7 in the final measurement.</p>
<p>Begin encoding ‘5’ as ‘101’. In the unrolled circuit this is represented as an X gate (aka U3(π,0,π)) on q_num_0 and q_num_3 using a double sized register.</p>
<p>We use a fake quantum coin since our add_gate is prepared for the random walk, which is meant to activate the add_gate, this is represented by the X gate on q_num_3.</p>
<p>Then, since value = ‘2’ the add_gate applies two times the ladder of mcx.</p>
<p>Final measurement is performed only on the encoded qubits, using a statevector simulator to obtain the ideal result, ‘111’ = 7.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;statevector&quot;</span><span class="p">)</span>

<span class="n">NUM</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># encode &#39;5&#39; in register</span>
<span class="n">ADD_VALUE</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># add &#39;2&#39; to register</span>

<span class="n">qc</span> <span class="o">=</span> <span class="n">encode_basis</span><span class="p">(</span><span class="n">NUM</span><span class="p">,</span> <span class="n">double</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># use &#39;double&#39; to allow space for quantum coin</span>

<span class="n">QCNUM_SIZE</span> <span class="o">=</span> <span class="n">qc</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># actual size of encoded info in circuit</span>

<span class="n">qc</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">QCNUM_SIZE</span><span class="p">)</span>  <span class="c1"># set fake quantum coin to &#39;1&#39; = add</span>

<span class="n">qc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">add_gate</span><span class="p">(</span><span class="n">QCNUM_SIZE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ADD_VALUE</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">QCNUM_SIZE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">qc</span><span class="o">.</span><span class="n">add_register</span><span class="p">(</span>
    <span class="n">ClassicalRegister</span><span class="p">(</span><span class="n">QCNUM_SIZE</span><span class="p">)</span>
<span class="p">)</span>  <span class="c1"># measure only qubits that encode the number</span>
<span class="n">qc</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">QCNUM_SIZE</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">QCNUM_SIZE</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qc</span><span class="o">.</span><span class="n">decompose</span><span class="p">())</span>


<span class="n">job</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qc</span><span class="o">.</span><span class="n">decompose</span><span class="p">(),</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">result</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="sub-gate">
<h3>Sub gate<a class="headerlink" href="#sub-gate" title="Link to this heading">#</a></h3>
<p>How to make a sub gate efficiently? We can exploit a feature exclusive to quantum computing, reversibility!</p>
<p>A sub_gate is then just an add_gate in reverse:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sub_gate</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">sub</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sub&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="n">sub</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">sub</span><span class="o">.</span><span class="n">mcx</span><span class="p">([</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="p">[</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">)]],</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">sub</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sub</span><span class="o">.</span><span class="n">to_instruction</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We can run the same example as before with the sub gate, to show that if we start from ‘5’ and we subtract ‘2’ we obtain 5 - 2 = 3 (aka ‘011’)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">NUM</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># encode &#39;5&#39; in register</span>
<span class="n">SUB_VALUE</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># sub &#39;2&#39; to register</span>

<span class="n">qc</span> <span class="o">=</span> <span class="n">encode_basis</span><span class="p">(</span><span class="n">NUM</span><span class="p">,</span> <span class="n">double</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># use &#39;double&#39; to allow space for quantum coin</span>

<span class="n">QCNUM_SIZE</span> <span class="o">=</span> <span class="n">qc</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># actual size of encoded info in circuit</span>

<span class="n">qc</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">QCNUM_SIZE</span><span class="p">)</span>  <span class="c1"># set fake quantum coin to &#39;1&#39; = sub</span>

<span class="n">qc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_gate</span><span class="p">(</span><span class="n">QCNUM_SIZE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SUB_VALUE</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">QCNUM_SIZE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">qc</span><span class="o">.</span><span class="n">add_register</span><span class="p">(</span>
    <span class="n">ClassicalRegister</span><span class="p">(</span><span class="n">QCNUM_SIZE</span><span class="p">)</span>
<span class="p">)</span>  <span class="c1"># measure only qubits that encode the number</span>
<span class="n">qc</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">QCNUM_SIZE</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">QCNUM_SIZE</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qc</span><span class="o">.</span><span class="n">decompose</span><span class="p">())</span>


<span class="n">job</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qc</span><span class="o">.</span><span class="n">decompose</span><span class="p">(),</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">result</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="apply-the-gates-to-the-position-circuit-conditioned-to-the-coin-flip-for-steps-number-of-times">
<h2>4) Apply the gates to the position circuit, conditioned to the coin-flip, for steps number of times<a class="headerlink" href="#apply-the-gates-to-the-position-circuit-conditioned-to-the-coin-flip-for-steps-number-of-times" title="Link to this heading">#</a></h2>
<p>We now have all the ingredients necessary to compute a classical random walk on a quantum computer.
We need to decide for each time step whether to add or subtract a value from the current position. How to implement conditioned coin flip at each time step?</p>
<p>We prepared the both the add_gate and the sub_gate to be controlled by an extra qubit, which is going to be a quantum coin qubit. This means that we can create a quantum coin for each time step, add it to our quantum register and use it to decide how to move.</p>
<p><strong>RQ: Is there a way of using only one qubit to perform all the coin flips? If one could reset the state of the qubit (i.e. using mid-circuit measurements) one could re-initialize the quantum coin as if it were a brand new qubit</strong></p>
<p>To concatenate the two circuits we create an helper function, cat_qc. This function takes a variable number of QuantumCircuit objects, combines their quantum and classical registers to initialize a new circuit, and then iteratively composes the operations of each input circuit into the new concatenated circuit. This effectively joins the operations of multiple circuits together while ensuring proper handling of qubit and classical bit indices.</p>
<p>We also provide a helper function to decode the binary results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">decode_result</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>


<span class="k">def</span> <span class="nf">cat_qc</span><span class="p">(</span><span class="o">*</span><span class="n">all_qc</span><span class="p">):</span>
    <span class="n">out_qc_qregs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">out_qc_cregs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">qc</span> <span class="ow">in</span> <span class="n">all_qc</span><span class="p">:</span>
        <span class="n">out_qc_qregs</span> <span class="o">+=</span> <span class="n">qc</span><span class="o">.</span><span class="n">qregs</span>
        <span class="n">out_qc_cregs</span> <span class="o">+=</span> <span class="n">qc</span><span class="o">.</span><span class="n">cregs</span>
    <span class="n">out_qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="o">*</span><span class="n">out_qc_qregs</span><span class="p">,</span> <span class="o">*</span><span class="n">out_qc_cregs</span><span class="p">)</span>

    <span class="n">qubits_offset</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">clbits_offset</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">qc</span> <span class="ow">in</span> <span class="n">all_qc</span><span class="p">:</span>
        <span class="n">out_qc</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span>
            <span class="n">qc</span><span class="p">,</span>
            <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qubits_offset</span><span class="p">,</span> <span class="n">qubits_offset</span> <span class="o">+</span> <span class="n">qc</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)],</span>
            <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">clbits_offset</span><span class="p">,</span> <span class="n">clbits_offset</span> <span class="o">+</span> <span class="n">qc</span><span class="o">.</span><span class="n">num_clbits</span><span class="p">)],</span>
            <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">qubits_offset</span> <span class="o">+=</span> <span class="n">qc</span><span class="o">.</span><span class="n">num_qubits</span>
        <span class="n">clbits_offset</span> <span class="o">+=</span> <span class="n">qc</span><span class="o">.</span><span class="n">num_clbits</span>

    <span class="k">return</span> <span class="n">out_qc</span>
</pre></div>
</div>
</div>
</div>
<p>We can show in this example how a classical random walk circuit would look like</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">qnum</span> <span class="o">=</span> <span class="n">encode_basis</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">double</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">steps</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">num_coins</span> <span class="o">=</span> <span class="n">steps</span>

<span class="n">qc</span> <span class="o">=</span> <span class="n">cat_qc</span><span class="p">(</span><span class="n">qnum</span><span class="p">,</span> <span class="o">*</span><span class="p">[</span><span class="n">qcoin</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_coins</span><span class="p">)])</span>
<span class="n">add</span> <span class="o">=</span> <span class="n">add_gate</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">sub</span> <span class="o">=</span> <span class="n">sub_gate</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting number in dec: </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting number in bin: </span><span class="si">{</span><span class="nb">bin</span><span class="p">(</span><span class="n">n</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Num steps: </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Num qubits: </span><span class="si">{</span><span class="n">qc</span><span class="o">.</span><span class="n">num_qubits</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)),</span> <span class="n">qc</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">])</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)),</span> <span class="n">qc</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qc</span><span class="o">.</span><span class="n">decompose</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="put-the-circuit-together-run-experiments-and-show-the-final-distribution">
<h2>5) Put the circuit together, run experiments and show the final distribution<a class="headerlink" href="#put-the-circuit-together-run-experiments-and-show-the-final-distribution" title="Link to this heading">#</a></h2>
<p>In a final example we showcase how to compute many random walks simultaneously using the qasm_simulator to obtain a final position distribution</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span> <span class="o">=</span> <span class="n">QasmSimulator</span><span class="p">()</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">7</span>
<span class="n">qnum</span> <span class="o">=</span> <span class="n">encode_basis</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">double</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">steps</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">num_coins</span> <span class="o">=</span> <span class="n">steps</span>

<span class="n">qc</span> <span class="o">=</span> <span class="n">cat_qc</span><span class="p">(</span><span class="n">qnum</span><span class="p">,</span> <span class="o">*</span><span class="p">[</span><span class="n">qcoin</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_coins</span><span class="p">)])</span>

<span class="n">add</span> <span class="o">=</span> <span class="n">add_gate</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sub</span> <span class="o">=</span> <span class="n">sub_gate</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting number in dec: </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Num steps: </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Num qubits: </span><span class="si">{</span><span class="n">qc</span><span class="o">.</span><span class="n">num_qubits</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)),</span> <span class="n">qc</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">])</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)),</span> <span class="n">qc</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">])</span>

<span class="n">qc</span><span class="o">.</span><span class="n">add_register</span><span class="p">(</span><span class="n">ClassicalRegister</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">qc</span><span class="o">.</span><span class="n">measure</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)])</span>


<span class="n">job</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qc</span><span class="o">.</span><span class="n">decompose</span><span class="p">(),</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>


<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">10.24</span><span class="p">,</span> <span class="mf">7.68</span><span class="p">))</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">decode_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Counts&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We can generate biased distributions and compare them to the unbiased one</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span> <span class="o">=</span> <span class="n">QasmSimulator</span><span class="p">()</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">7</span>
<span class="n">qnum</span> <span class="o">=</span> <span class="n">encode_basis</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">double</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">steps</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">num_coins</span> <span class="o">=</span> <span class="n">steps</span>

<span class="n">qc_bias_zero</span> <span class="o">=</span> <span class="n">cat_qc</span><span class="p">(</span>
    <span class="n">qnum</span><span class="p">,</span>
    <span class="o">*</span><span class="p">[</span>
        <span class="n">qcoin</span><span class="p">(</span>
            <span class="mf">0.4</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_coins</span><span class="p">)</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">qc_bias_one</span> <span class="o">=</span> <span class="n">cat_qc</span><span class="p">(</span><span class="n">qnum</span><span class="p">,</span> <span class="o">*</span><span class="p">[</span><span class="n">qcoin</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_coins</span><span class="p">)])</span>

<span class="n">add</span> <span class="o">=</span> <span class="n">add_gate</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sub</span> <span class="o">=</span> <span class="n">sub_gate</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">qc_bias_zero</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)),</span> <span class="n">qc_bias_zero</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">])</span>
    <span class="n">qc_bias_zero</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)),</span> <span class="n">qc_bias_zero</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">])</span>

<span class="n">qc_bias_zero</span><span class="o">.</span><span class="n">add_register</span><span class="p">(</span><span class="n">ClassicalRegister</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">qc_bias_zero</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span>
    <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)]</span>
<span class="p">)</span>


<span class="n">job_bias_zero</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qc_bias_zero</span><span class="o">.</span><span class="n">decompose</span><span class="p">(),</span> <span class="n">shots</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">result_bias_zero</span> <span class="o">=</span> <span class="n">job_bias_zero</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
<span class="n">result_bias_zero</span> <span class="o">=</span> <span class="n">decode_result</span><span class="p">(</span><span class="n">result_bias_zero</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">qc_bias_one</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)),</span> <span class="n">qc_bias_one</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">])</span>
    <span class="n">qc_bias_one</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)),</span> <span class="n">qc_bias_one</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">])</span>

<span class="n">qc_bias_one</span><span class="o">.</span><span class="n">add_register</span><span class="p">(</span><span class="n">ClassicalRegister</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">qc_bias_one</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span>
    <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)]</span>
<span class="p">)</span>


<span class="n">job_bias_one</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qc_bias_one</span><span class="o">.</span><span class="n">decompose</span><span class="p">(),</span> <span class="n">shots</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">result_bias_one</span> <span class="o">=</span> <span class="n">job_bias_one</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
<span class="n">result_bias_one</span> <span class="o">=</span> <span class="n">decode_result</span><span class="p">(</span><span class="n">result_bias_one</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">10.24</span><span class="p">,</span> <span class="mf">7.68</span><span class="p">))</span>

<span class="n">x0</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">result_bias_zero</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="n">result_bias_zero</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">x0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;bias zero&quot;</span><span class="p">)</span>

<span class="n">x1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">result_bias_one</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">y1</span> <span class="o">=</span> <span class="p">[</span><span class="n">result_bias_one</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">x1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;bias one&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;unbiased&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Counts&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="improving-the-circuit-with-qft">
<h2>6) Improving the circuit with QFT<a class="headerlink" href="#improving-the-circuit-with-qft" title="Link to this heading">#</a></h2>
<p>As mentioned before, the add and sub gates are not easily implemented in all machines. However we can make use of the <a class="reference external" href="https://learn.qiskit.org/course/ch-algorithms/quantum-fourier-transform">Quantum Fourier Transform</a> to move our position number into the phases of the qubits, moving from “basis encoding” to “phase encoding” with a QFT transformation.</p>
<p>We can then add and subtract in the phase space (with different add and sub gates suitable for this encoding) and finally decode our number back to basis encoding with an inverse QFT.</p>
<p>Let’s introduce the new add and sub gates. For this example we will make a simple increment / decrement gate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_qft_gate</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">add</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;add_qft&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">add</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">q</span><span class="p">),</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
    <span class="n">add</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">add</span><span class="o">.</span><span class="n">to_instruction</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">sub_qft_gate</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">add</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sub_qft&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">add</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="o">-</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">q</span><span class="p">),</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
    <span class="n">add</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">add</span><span class="o">.</span><span class="n">to_instruction</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We can compare the cost of implementing the two variations (MCX and QFT) of the same random walk. We observe that the QFT allows us to create much shorter circuits, with less complicated gates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">7</span>
<span class="n">qnum</span> <span class="o">=</span> <span class="n">encode_basis</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">double</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">add</span> <span class="o">=</span> <span class="n">add_gate</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">sub</span> <span class="o">=</span> <span class="n">sub_gate</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">add_qft</span> <span class="o">=</span> <span class="n">add_qft_gate</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">sub_qft</span> <span class="o">=</span> <span class="n">sub_qft_gate</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">steps</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">num_coins</span> <span class="o">=</span> <span class="n">steps</span>

<span class="n">qc</span> <span class="o">=</span> <span class="n">cat_qc</span><span class="p">(</span><span class="n">qnum</span><span class="p">,</span> <span class="o">*</span><span class="p">[</span><span class="n">qcoin</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_coins</span><span class="p">)])</span>
<span class="n">qc_qft</span> <span class="o">=</span> <span class="n">cat_qc</span><span class="p">(</span><span class="n">qnum</span><span class="p">,</span> <span class="o">*</span><span class="p">[</span><span class="n">qcoin</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_coins</span><span class="p">)])</span>

<span class="n">qc_qft</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
    <span class="n">QFT</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">,</span> <span class="n">do_swaps</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">decompose</span><span class="p">(),</span>
    <span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">),</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">qc_qft</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">add_qft</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)),</span> <span class="n">qc_qft</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">])</span>
    <span class="n">qc_qft</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_qft</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)),</span> <span class="n">qc_qft</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">])</span>
<span class="n">qc_qft</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
    <span class="n">QFT</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">,</span> <span class="n">do_swaps</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">decompose</span><span class="p">(),</span> <span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)</span>
<span class="p">)</span>
<span class="c1"># print(qc_qft.decompose())</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)),</span> <span class="n">qc</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">])</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)),</span> <span class="n">qc</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Multi-control-X circuit depth: </span><span class="si">{</span><span class="n">qc</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;QFT circuit depth: </span><span class="si">{</span><span class="n">qc_qft</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Multi-control-X instructions: </span><span class="si">{</span><span class="nb">dict</span><span class="p">(</span><span class="n">qc</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span><span class="o">.</span><span class="n">count_ops</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;QFT circuit instructions: </span><span class="si">{</span><span class="nb">dict</span><span class="p">(</span><span class="n">qc_qft</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span><span class="o">.</span><span class="n">count_ops</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The two variations should have the same outcome. Let’s see if this is the case:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span> <span class="o">=</span> <span class="n">QasmSimulator</span><span class="p">()</span>


<span class="n">qc</span><span class="o">.</span><span class="n">add_register</span><span class="p">(</span><span class="n">ClassicalRegister</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">qc</span><span class="o">.</span><span class="n">measure</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)])</span>


<span class="n">job</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qc</span><span class="o">.</span><span class="n">decompose</span><span class="p">(),</span> <span class="n">shots</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">decode_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">qc_qft</span><span class="o">.</span><span class="n">add_register</span><span class="p">(</span><span class="n">ClassicalRegister</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">qc_qft</span><span class="o">.</span><span class="n">measure</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)])</span>


<span class="n">job_qft</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qc_qft</span><span class="o">.</span><span class="n">decompose</span><span class="p">(),</span> <span class="n">shots</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">result_qft</span> <span class="o">=</span> <span class="n">job_qft</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
<span class="n">result_qft</span> <span class="o">=</span> <span class="n">decode_result</span><span class="p">(</span><span class="n">result_qft</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">10.24</span><span class="p">,</span> <span class="mf">7.68</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MCX&quot;</span><span class="p">)</span>

<span class="n">x_qft</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">result_qft</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">y_qft</span> <span class="o">=</span> <span class="p">[</span><span class="n">result_qft</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">x_qft</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_qft</span><span class="p">,</span> <span class="n">y_qft</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;QFT&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Counts&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Here is the same code with 40 steps. You can observe that thanks to the particular structure of the QFT we are able to simulate many more qubits that are available through MCX. If you decomment the comments you will obtain a memory error</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span> <span class="o">=</span> <span class="n">QasmSimulator</span><span class="p">()</span>


<span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">7</span>
<span class="n">qnum</span> <span class="o">=</span> <span class="n">encode_basis</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">double</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># add = add_gate(qnum.num_qubits+1)</span>
<span class="c1"># sub = sub_gate(qnum.num_qubits+1)</span>
<span class="n">add_qft</span> <span class="o">=</span> <span class="n">add_qft_gate</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">sub_qft</span> <span class="o">=</span> <span class="n">sub_qft_gate</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">steps</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">num_coins</span> <span class="o">=</span> <span class="n">steps</span>

<span class="c1"># qc = cat_qc(qnum,*[qcoin() for _ in range(num_coins)])</span>
<span class="n">qc_qft</span> <span class="o">=</span> <span class="n">cat_qc</span><span class="p">(</span><span class="n">qnum</span><span class="p">,</span> <span class="o">*</span><span class="p">[</span><span class="n">qcoin</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_coins</span><span class="p">)])</span>

<span class="n">qc_qft</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
    <span class="n">QFT</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">,</span> <span class="n">do_swaps</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">decompose</span><span class="p">(),</span>
    <span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">),</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">qc_qft</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">add_qft</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)),</span> <span class="n">qc_qft</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">])</span>
    <span class="n">qc_qft</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_qft</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)),</span> <span class="n">qc_qft</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">])</span>
<span class="n">qc_qft</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
    <span class="n">QFT</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">,</span> <span class="n">do_swaps</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">decompose</span><span class="p">(),</span> <span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># for i in range(steps):</span>
<span class="c1">#     qc.append(add,[*(range(qnum.num_qubits)), qc.num_qubits-1-i])</span>
<span class="c1">#     qc.append(sub,[*(range(qnum.num_qubits)), qc.num_qubits-1-i])</span>

<span class="c1"># print(f&#39;Multi-control-X circuit depth: {qc.decompose().decompose().depth()}&#39;)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;QFT circuit qubit number: </span><span class="si">{</span><span class="n">qc_qft</span><span class="o">.</span><span class="n">num_qubits</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;QFT circuit depth: </span><span class="si">{</span><span class="n">qc_qft</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># print(f&#39;Multi-control-X instructions: {dict(qc.decompose().decompose().count_ops())}&#39;)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;QFT circuit instructions: </span><span class="si">{</span><span class="nb">dict</span><span class="p">(</span><span class="n">qc_qft</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span><span class="o">.</span><span class="n">count_ops</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># qc.add_register(ClassicalRegister(qnum.num_qubits+1))</span>
<span class="c1"># qc.measure([i for i in range(qnum.num_qubits)],[i for i in range(qnum.num_qubits)])</span>
<span class="c1"># backend = Aer.get_backend(&#39;qasm_simulator&#39;)</span>
<span class="c1"># job = execute(qc, backend, shots=5000)</span>
<span class="c1"># result = job.result().get_counts(qc)</span>
<span class="c1"># result = decode_result(result)</span>

<span class="n">qc_qft</span><span class="o">.</span><span class="n">add_register</span><span class="p">(</span><span class="n">ClassicalRegister</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">qc_qft</span><span class="o">.</span><span class="n">measure</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qnum</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)])</span>

<span class="c1"># backend = Aer.get_backend(&#39;qasm_simulator&#39;)</span>
<span class="c1"># job_qft = execute(qc_qft, backend, shots=5000)</span>
<span class="c1"># result_qft = job_qft.result().get_counts(qc_qft)</span>
<span class="c1"># result_qft = decode_result(result_qft)</span>

<span class="n">job_qft</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qc_qft</span><span class="o">.</span><span class="n">decompose</span><span class="p">(),</span> <span class="n">shots</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">result_qft</span> <span class="o">=</span> <span class="n">job_qft</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
<span class="n">result_qft</span> <span class="o">=</span> <span class="n">decode_result</span><span class="p">(</span><span class="n">result_qft</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">10.24</span><span class="p">,</span> <span class="mf">7.68</span><span class="p">))</span>

<span class="c1"># x = sorted(result.keys())</span>
<span class="c1"># y = [result[k] for k in x]</span>
<span class="c1"># ax.plot(x, y, label=&#39;MCX&#39;)</span>

<span class="n">x_qft</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">result_qft</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">y_qft</span> <span class="o">=</span> <span class="p">[</span><span class="n">result_qft</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">x_qft</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_qft</span><span class="p">,</span> <span class="n">y_qft</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;QFT&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Counts&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Quantum Walk</p>
      </div>
    </a>
    <a class="right-next"
       href="QuantumRandomWalk.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Quantum Random Walk on a Quantum Computer</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#in-our-setting-we-consider-a-typical-classical-1-d-random-walk-setting-consisting-of">In our setting we consider a typical classical 1-D random walk setting, consisting of:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#can-we-use-a-quantum-computer-to-evolve-a-lot-of-these-experiments-simultaneously">Can we use a quantum computer to evolve a lot of these experiments simultaneously?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encode-the-starting-position-in-a-quantum-circuit">1) Encode the starting position in a quantum circuit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-coin-flip-circuit">2) Create a coin-flip circuit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-add-and-sub-gates">3) Create add and sub gates</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-gate">Add gate</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sub-gate">Sub gate</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apply-the-gates-to-the-position-circuit-conditioned-to-the-coin-flip-for-steps-number-of-times">4) Apply the gates to the position circuit, conditioned to the coin-flip, for steps number of times</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#put-the-circuit-together-run-experiments-and-show-the-final-distribution">5) Put the circuit together, run experiments and show the final distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#improving-the-circuit-with-qft">6) Improving the circuit with QFT</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By NordIQuEst
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, NordIQuEst.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>