
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tutorial - Fault-Tolerant Quantum Computing with CSS codes &#8212; NordIQuEst Application Library</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx_lesson.css?v=e9df6548" />
    <link rel="stylesheet" type="text/css" href="../../../_static/term_role_formatting.css?v=4194e21c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/minipres.js?v=a0d29692"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>window.MathJax = {"tex": {"macros": {"vr": "\\vec{r}", "ket": ["\\left| #1 \\right\\rangle", 1], "bra": ["\\left| #1 \\right\\langle", 1], "iprod": ["\\left\\langle #1 | #2 \\right\\rangle", 2]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'training-material/qas2024/notebooks/css_code_steane';</script>
    <link rel="icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Tutorial - MAP Decoding Exercise" href="decoding_excercise.html" />
    <link rel="prev" title="Notebooks" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/nq_logo2.png" class="logo__image only-light" alt="NordIQuEst Application Library - Home"/>
    <script>document.write(`<img src="../../../_static/nq_logo2.png" class="logo__image only-dark" alt="NordIQuEst Application Library - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Application Library</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../README.html"><strong>NordIQuEst Application Library</strong></a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../hybrid-algorithms/index.html"><strong>Hybrid Algorithms</strong></a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../hybrid-algorithms/QAOA/index.html">Quantum Approximate Optimization Algorithm (QAOA)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../hybrid-algorithms/QAOA/MaxCut.html">Comparison of Different Optimizers for QAOA on a Max Cut instance</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../hybrid-algorithms/Quantum%20Chemistry/index.html">Quantum Chemistry</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../hybrid-algorithms/Quantum%20Chemistry/Installation.html">Installation instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../hybrid-algorithms/Quantum%20Chemistry/Theory.html">Theory: Quantum Chemistry on Quantum Computers</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../../hybrid-algorithms/Quantum%20Chemistry/VQE.html">Notebook example: VQE</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../hybrid-algorithms/Quantum%20Walk/index.html">Quantum Walk</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../hybrid-algorithms/Quantum%20Walk/ClassicalRandomWalk.html">Classical Random Walk on a Quantum Computer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../hybrid-algorithms/Quantum%20Walk/QuantumRandomWalk.html">Quantum Random Walk on a Quantum Computer</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../hybrid-algorithms/VQE/index.html">Variational Quantum Eigensolver (VQE) Tutorial</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../hybrid-algorithms/VQE/vqe-h2-cirq.html">Cirq: Variational Quantum Eigensolver for <span class="math notranslate nohighlight">\(H_2\)</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../hybrid-algorithms/VQE/vqe-h2-qiskit.html">Qiskit: Variational Quantum Eigensolver for <span class="math notranslate nohighlight">\(H_2\)</span></a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../hybrid-algorithms/QuantumReservoirComputing/index.html">Quantum Reservoir Computing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../hybrid-algorithms/QuantumReservoirComputing/Logistic%20map.html">Quantum Reservoir Computing: Logistic map</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../real-devices/index.html"><strong>Real Devices</strong></a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../real-devices/ex3-qal9000-demo/index.html">ex3-qal9000 Demo</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../real-devices/ex3-qal9000-demo/compute-bloch-frames.html">ex3-qal9000 Demo: StateTomography on QAL9000</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../real-devices/intro-to-helmi-qiskit.html">Introduction to Helmi with Qiskit</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../simulators/index.html"><strong>Simulators</strong></a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../simulators/ex3/index.html">ex3 Simulators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../simulators/ex3/qiskit/README.html">Running Quantum programs on the Qiskit Simulator in eX3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../simulators/ex3/qsim/README.html">QSIM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../simulators/ex3/QuEST/README.html">Guide of Running QuEST in eX3</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../simulators/lumi/index.html">LUMI Simulators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../simulators/lumi/qiskit/index.html">Qiskit</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../simulators/lumi/qiskit/v0.12.0/README.html">v0.12.0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../simulators/lumi/qiskit/v1.1.1/README.html">v1.1.1</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../../simulators/lumi/qsim/README.html">QSim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../simulators/lumi/QuEST/README.html">QuEST</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../index.html"><strong>Training Material Archive</strong></a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../../qas2022/index.html">Quantum Autumn School 2022</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../qas2022/notebooks/index.html">Notebooks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../qas2022/notebooks/E1_qc-1.html"><strong>Quantum programming I</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../qas2022/notebooks/E1_qc-2.html"><strong>Quantum programming II</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../qas2022/notebooks/E1_qc-3.html"><strong>Quantum programming III</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../qas2022/notebooks/E2_optimization.html"><strong>Use case: Optimization</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../qas2022/notebooks/E2_VQE-H2.html"><strong>Use case: Quantum chemistry</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../qas2022/notebooks/quito.html">Quantum software testing with Quito</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../qas2022/slides/index.html">Slides</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../qas2022/slides/landscape.html">The HPC-QC landscape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../qas2022/slides/qc_hardware.html">Overview of different QC hardware approaches and QC types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../qas2022/slides/programming_qc.html">Introduction to high-level languages for QC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../qas2022/slides/hybrid_hpc_qc.html">The hybrid HPC-QC approach</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../qas2022/slides/software_stack_overview.html">Overview of the software stack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../qas2022/slides/hybrid_algorithms.html">Hybrid classical/quantum algorithms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../qas2022/slides/qc_testing.html">Quantum software testing</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../qas2023/index.html">Quantum Autumn School 2023</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../qas2023/notebooks/index.html">Notebooks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../qas2023/notebooks/E2_VQE-H2.html">Tutorial - Quantum chemistry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../qas2023/notebooks/intro-to-helmi-qiskit.html">Tutorial - Introduction to Helmi with qiskit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../qas2023/notebooks/Notebook_maxcut_Qas2023.html">Tutorial - Quantum Alternating Operator Ansatz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../qas2023/notebooks/Notebook_maxcut_Qas2023_sol.html">Solutions - Tutorial - Quantum Alternating Operator Ansatz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../qas2023/notebooks/Qubit_Spectroscopy_Analysis.html">Tutorial - Qubit Spectroscopy Analysis</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../qas2023/slides/index.html">Slides</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../qas2023/slides/hpc-qc.html">HPC-QC integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../qas2023/slides/software-stack.html">QC software stack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../qas2023/slides/hybrid-classical-quantum.html">Hybrid Classical/Quantum Algorithms</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../neic2024-qc101/index.html">NeIC 2024 Workshop: Quantum Computing 101</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../neic2024-qc101/setup.html">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../neic2024-qc101/notebooks/introduction-to-using-a-qc.html"><strong>Workshop: Quantum Computing 101 Part I</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../neic2024-qc101/notebooks/introduction-to-using-a-qc-2.html"><strong>Workshop: Quantum Computing 101 Part II</strong></a></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../index.html">Quantum Autumn School 2024</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active has-children"><a class="reference internal" href="index.html">Notebooks</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l4 current active"><a class="current reference internal" href="#">Tutorial - Fault-Tolerant Quantum Computing with CSS codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="decoding_excercise.html">Tutorial - MAP Decoding Exercise</a></li>
<li class="toctree-l4"><a class="reference internal" href="flight_scheduling_optimization_qaoa.html">Tutorial - Solving Flight Scheduling Optimization using QAOA</a></li>
<li class="toctree-l4"><a class="reference internal" href="ghz_estimator_attendees.html">Tutorial - Introduction to Helmi</a></li>
<li class="toctree-l4"><a class="reference internal" href="option_pricing_tutorial.html">Tutorial - Pricing a European call option using quantum computing</a></li>
<li class="toctree-l4"><a class="reference internal" href="option_pricing.html">Tutorial - Pricing a European call option on a quantum computer</a></li>
<li class="toctree-l4"><a class="reference internal" href="qaoa_exercise.html">Tutorial - Variational Quantum Algorithms</a></li>
<li class="toctree-l4"><a class="reference internal" href="surface_code_threshold.html">Tutorial - Estimating the Surface Code Threshold</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../slides/index.html">Slides</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../slides/qas24-integration-hpc-qc.html">Integration of High Performance Computing and Quantum Computing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slides/qas24-mat-sci-on-qc.html">Quantum Computing for Materials Science</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slides/qas24-tergite-overview.html">Tergite Software Stack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slides/qas24-intro-helmi.html">Introduction to Helmi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slides/qas24-quantum-walks.html">Quantum walks on quantum computers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slides/qas24-qelm-case-study.html">Quantum Extreme Learning Machine: Case Studies on Software Testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slides/qas24-quantum-option-pricing.html">Option pricing on a quantum computer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slides/qas24-quantum-error-correction.html">Quantum Error Correction: Theory and Hands-on</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slides/qas24-distributed-quantum-computing.html">Distributed Quantum Computing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slides/qas24-amplitude-estimation.html">Quantum Amplitude Estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slides/qas24-qsip-innovation-platform.html">Quantum Sweden Innovation Platform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slides/qas24-vqe-and-qaoa.html">Introduction to variational quantum algorithms: VQE and QAOA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slides/qas24-ncc-hpc-ai-iceland.html">Icelandic National Competence Center (NCC) for HPC &amp; AI â€“ Quantum Computing Activities</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../testing-tools/index.html"><strong>Quantum Software Testing Tools</strong></a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../testing-tools/README.html">Run Software Testing Tools on Jupyter Notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../testing-tools/tutorial_quito.html">Welcome to Quito!</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../testing-tools/tutorial_qusbt.html">Welcome to QuSBT!</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../testing-tools/tutorial_qucat.html">Welcome to QuCAT!</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Information</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../docs/authors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/acknowledgement.html">Acknowledgement</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/NordIQuEst/application-library" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/training-material/qas2024/notebooks/css_code_steane.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tutorial - Fault-Tolerant Quantum Computing with CSS codes</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#steane-code">Steane Code</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-construction">Code Construction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-steane-code">Visualizing the Steane Code</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#excursion-stim-and-stabilizer-formalism">Excursion: Stim and Stabilizer formalism</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pauli-strings">Pauli Strings</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tableau">Tableau</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#circuit">Circuit</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#logical-operators-of-the-steane-code">Logical Operators of the Steane Code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-computing-with-logical-qubits">Quantum Computing with Logical Qubits</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#state-initialization">State Initialization</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#different-basis-state-preparation">Different Basis State Preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#measuring-in-different-basis">Measuring in different Basis</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transversal-gates">Transversal gates</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#logical-cnot-implementation">Logical CNOT Implementation</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#logical-bell-state">Logical Bell State</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-simulating-the-steane-code-on-noisy-hardware-quantinuum-experiment">Optional: Simulating the Steane Code on noisy Hardware: Quantinuum Experiment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-errors">Introducing Errors</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#quantinuum-error-parameters">Quantinuum error parameters</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#faulty-logical-state-preparation">Faulty logical state preparation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#syndrome-extraction">Syndrome extraction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#full-qec-cycle">Full QEC cycle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-decoder">The Decoder</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-logical-error-rates-for-steane-code-for-each-basis">Simulating Logical Error Rates for Steane Code for each Basis</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tutorial-fault-tolerant-quantum-computing-with-css-codes">
<h1>Tutorial - Fault-Tolerant Quantum Computing with CSS codes<a class="headerlink" href="#tutorial-fault-tolerant-quantum-computing-with-css-codes" title="Link to this heading">#</a></h1>
<p>In this notebook weâ€™ll explore how fault-tolerant quantum computing looks like at the <strong>circuit-level</strong>.</p>
<p>For our exploration weâ€™ll introduce the <em>Steane Code</em>, proposed by Andrew Steane in 1996. It is a quantum code from the class of <em>Calderbank-Shor-Steane (CSS)</em> codes which was introduced in the lecture.</p>
<p>Our <strong>goal</strong> is to understand:</p>
<ul class="simple">
<li><p>How is a logical qubit prepared at the circuit-level?</p></li>
<li><p>How can we implement logical gates between those logical qubits?</p></li>
<li><p>How does the quantum error correction procedure looks like at the circuit-level?</p></li>
</ul>
<p>Letâ€™s explore the Steane code! ðŸ”­</p>
<section id="steane-code">
<h2>Steane Code<a class="headerlink" href="#steane-code" title="Link to this heading">#</a></h2>
<p>The Steane code is a <span class="math notranslate nohighlight">\([[7,1,3]]\)</span> stabilizer code, which means that it encodes 7 physical qubits into 1 logical qubits. Its code distance is <span class="math notranslate nohighlight">\(d=3\)</span>, meaning that it will correct up to
$<span class="math notranslate nohighlight">\(t = \lfloor 3 - 1 /2 \rfloor = 1\)</span>$
errors.</p>
<section id="code-construction">
<h3>Code Construction<a class="headerlink" href="#code-construction" title="Link to this heading">#</a></h3>
<p><strong>CSS codes:</strong></p>
<p>The class of Calderbank-Shor-Steane (CSS) codes provides a simple recipe of constructing quantum error correcting codes from classical <em>linear</em> codes.
In a linear <span class="math notranslate nohighlight">\([n,k]\)</span>-code <span class="math notranslate nohighlight">\(C\)</span>, the code space is defined by the kernel of a parity check matrix <span class="math notranslate nohighlight">\(H \in \mathbb{Z}_2^{n - k \times n}\)</span>.</p>
<p>Meaning that for a code word <span class="math notranslate nohighlight">\(x \in \mathbb{Z}_2^n\)</span>, we must have:</p>
<div class="math notranslate nohighlight">
\[Hx = 0.\]</div>
<p>Since we have to protect our quantum state from Pauli-<span class="math notranslate nohighlight">\(X\)</span> and Pauli-<span class="math notranslate nohighlight">\(Z\)</span> errors, CSS codes combine two classical linear codes <span class="math notranslate nohighlight">\(C_1\)</span> and <span class="math notranslate nohighlight">\(C_2\)</span>. The respective parity check matrices <span class="math notranslate nohighlight">\(H_1\)</span> and <span class="math notranslate nohighlight">\(H_2\)</span> define the <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> stabilizers. To emphasize this fact, weâ€™ll denote the matrices as <span class="math notranslate nohighlight">\(H_X\)</span> and <span class="math notranslate nohighlight">\(H_Z\)</span>.</p>
<p>The rows of the parity check matrices define the stabilizer.</p>
<blockquote>
<div><p><strong>Example:</strong> If the <span class="math notranslate nohighlight">\(i\)</span>-th row of <span class="math notranslate nohighlight">\(H_X\)</span> is given as <span class="math notranslate nohighlight">\(1001\)</span> then the corresponding stabilizer is <span class="math notranslate nohighlight">\(X_1X_4 = X_1 \otimes I_2 \otimes I_3 \otimes X_4\)</span>.</p>
</div></blockquote>
<p>Since all stabilizers from the same parity check matrix necessarily commute, we need to make sure that rows from <span class="math notranslate nohighlight">\(H_X\)</span> and <span class="math notranslate nohighlight">\(H_Z\)</span> commute. This is ensured if the number of qubits targeted by both stabilizer types is even for each possible pair of stabilizers.</p>
<blockquote>
<div><p><strong>Example:</strong> <span class="math notranslate nohighlight">\(X_1X_2X_5X_6\)</span> and <span class="math notranslate nohighlight">\(Z_1Z_2Z_3Z_4\)</span> commute as they both target qubits 1 and 2 which is an even number of qubits.</p>
</div></blockquote>
<p><strong>Parity Check Matrix:</strong></p>
<p>For the Steane code, we have <span class="math notranslate nohighlight">\(H_X = H_Z = H\)</span> with</p>
<div class="math notranslate nohighlight">
\[\begin{split}H = \begin{bmatrix}1 &amp; 1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 1 &amp; 1 &amp; 0 &amp; 1 &amp; 1 &amp; 0\\ 0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 1 &amp; 1\end{bmatrix}\end{split}\]</div>
<p><strong>Stabilizers:</strong></p>
<p>We can now define the generators of the stabilizer group corresponding to the Steane code based on <span class="math notranslate nohighlight">\(H\)</span>:</p>
<div class="math notranslate nohighlight">
\[S_X = \langle X_1X_2X_3X_4, X_2X_3X_5X_6, X_3X_4X_6X_7 \rangle\]</div>
<div class="math notranslate nohighlight">
\[S_Z = \langle Z_1Z_2Z_3Z_4, Z_2Z_3Z_5Z_6, Z_3Z_4Z_6Z_7 \rangle\]</div>
</section>
<section id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Link to this heading">#</a></h3>
<p>Given the stabilizers, write down a valid code state <span class="math notranslate nohighlight">\(|\psi \rangle = | \psi_1\rangle \otimes | \psi_2\rangle \otimes | \psi_3\rangle \otimes | \psi_4\rangle \otimes | \psi_5\rangle \otimes | \psi_6\rangle \otimes | \psi_7\rangle  \)</span> of the Steane code.</p>
<p>As a reminder, a valid code state is the simultaneous Eigenstate of all stabilizers such that:
$<span class="math notranslate nohighlight">\(S|\psi\rangle = |\psi\rangle \;\;\; \forall S \in S_X \cup S_Z\)</span>$</p>
<blockquote>
<div><p><strong>Tip:</strong> Any stabilizer can be decomposed into a product of generators. This means that only generators have to be considered when checking the stabilizing property.</p>
</div></blockquote>
</section>
<section id="visualizing-the-steane-code">
<h3>Visualizing the Steane Code<a class="headerlink" href="#visualizing-the-steane-code" title="Link to this heading">#</a></h3>
<p>To think about the properties of quantum error correcting codes it is often beneficial to visualize them. In the picture below, the vertices represent the physical qubits. Each coloured face defines an <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span>-type stabilizer.</p>
<p><img alt="Steane Code Plaquettes" src="../../../_images/steane-code-stabilizers.png" /></p>
<p>Putting the stabilizers together we get triangle with three faces also called <em>plaquettes</em> in the literature.</p>
<p><img alt="Steane Code Lattice" src="../../../_images/steane-code-lattice.png" /></p>
<p>Source: <a class="reference external" href="https://arthurpesah.me/blog/2023-01-31-stabilizer-formalism-1/">Arthur Pesahâ€™s blog post on the stabilizer formalism</a>.</p>
</section>
<section id="excursion-stim-and-stabilizer-formalism">
<h3>Excursion: Stim and Stabilizer formalism<a class="headerlink" href="#excursion-stim-and-stabilizer-formalism" title="Link to this heading">#</a></h3>
<p>To implement the Steane Code, weâ€™ll use Stim, a stabilizer simulator developed by Google, which is used for quantum error corection research.</p>
<p>Weâ€™ll introduce the 3 most important objects, which are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PauliString</span></code>: Representation of a Pauli string such as <span class="math notranslate nohighlight">\(X_1X_4\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Tableau</span></code>: A table holding the current stabilizers of a circuit.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Circuit</span></code>: Representation of quantum circuit similar to Qiskit.</p></li>
</ul>
<section id="pauli-strings">
<h4>Pauli Strings<a class="headerlink" href="#pauli-strings" title="Link to this heading">#</a></h4>
<p>A Pauli string is an <span class="math notranslate nohighlight">\(n\)</span>-qubit operator formed by taking the tensor product of single-qubit Pauli operators:</p>
<div class="math notranslate nohighlight">
\[P = P_1 \otimes P_2 \otimes \cdots \otimes P_n, \quad \text{where } P_i \in \{I, X, Z, Y\}\]</div>
<p>For example, a two-qubit Pauli string might be <span class="math notranslate nohighlight">\(P = X \otimes Y\)</span>, often written as <span class="math notranslate nohighlight">\(XY\)</span>.</p>
<blockquote>
<div><p><strong>Note:</strong> We usually omit the identity gates, by adding indices. For example, for <span class="math notranslate nohighlight">\(P = X \otimes I \otimes Y\)</span> is written as <span class="math notranslate nohighlight">\(X_1Y_3\)</span>.</p>
</div></blockquote>
<p><strong>Efficient Encoding of Pauli Strings in Software:</strong></p>
<p>Stim is designed to allow the simulation of very large stabilizer codes, so an efficient representation on a computer is crucial.
There are 4 different single-qubit Pauli operators, so 2 bits are required to represent them. Stim uses the following encoding:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
enc(I) &amp;= 00 \\
enc(X) &amp;= 10 \\
enc(Z) &amp;= 01 \\
enc(Y) &amp;= 11
\end{align*}
\end{split}\]</div>
<p>This encoding is chosen to reflect the algebraic properties of Pauli operators, also called a <a class="reference external" href="https://en.wikipedia.org/wiki/Group_homomorphism"><strong>group homomorphism</strong></a>: <span class="math notranslate nohighlight">\(enc : (G_1,\cdot) \rightarrow (\mathbb{Z}_2^2,\oplus)\)</span>.</p>
<p>The first bit indicates the presence of an <span class="math notranslate nohighlight">\(X\)</span> operation, while the second bit indicates a <span class="math notranslate nohighlight">\(Z\)</span> operation. The <span class="math notranslate nohighlight">\(Y\)</span> operator, can be decomposed into <span class="math notranslate nohighlight">\(X \cdot Z\)</span> and has therefore both bits set to 1.</p>
<p>This enables multiplication of Pauli operators through simple bitwise operations. For two Pauli operators <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>, their product (up to a global phase) is computed by:</p>
<div class="math notranslate nohighlight">
\[enc(A \cdot B) = enc(A) \oplus enc(B)\]</div>
<p>where <span class="math notranslate nohighlight">\(\oplus\)</span> represents bitwise XOR. For example:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
enc(X \cdot Y) &amp;= enc(X) \oplus enc(Y) \\
&amp;= 10 \oplus 11 \\
&amp;= 01 \\
&amp;= enc(Z)
\end{align*}
\end{split}\]</div>
<p>This matches the algebraic relation <span class="math notranslate nohighlight">\(XY = iZ\)</span> (ignoring the phase factor <span class="math notranslate nohighlight">\(i\)</span>).</p>
<p>Letâ€™s explore Stimâ€™s <a class="reference external" href="https://github.com/quantumlib/Stim/blob/main/doc/python_api_reference_vDev.md#stim.PauliString"><code class="docutils literal notranslate"><span class="pre">PauliString</span></code></a> API:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">stim</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">PauliString</span><span class="p">(</span><span class="s2">&quot;+XX&quot;</span><span class="p">)</span>
<span class="n">zz</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">PauliString</span><span class="p">(</span><span class="s2">&quot;+ZZ&quot;</span><span class="p">)</span>

<span class="c1"># Pauli strings can be multiplied</span>
<span class="n">mul_res</span> <span class="o">=</span> <span class="n">xx</span> <span class="o">*</span> <span class="n">zz</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Multiplication: XX * ZZ = &quot;</span><span class="p">,</span> <span class="n">mul_res</span><span class="p">)</span>

<span class="c1"># Pauli strings can be concatenated</span>
<span class="n">add_res</span> <span class="o">=</span> <span class="n">xx</span> <span class="o">+</span> <span class="n">zz</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Addition: XX + ZZ = &quot;</span><span class="p">,</span> <span class="n">add_res</span><span class="p">)</span>

<span class="c1"># We can check if 2 Pauli strings commute</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;XX and ZZ commute: &quot;</span><span class="p">,</span> <span class="n">xx</span><span class="o">.</span><span class="n">commutes</span><span class="p">(</span><span class="n">zz</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="tableau">
<h4>Tableau<a class="headerlink" href="#tableau" title="Link to this heading">#</a></h4>
<p>A tableau is the foundation of efficient simulation of stabilizer circuits. That is circuits, only composed of Clifford gates, mapping Pauli operators to other Pauli operators.</p>
<blockquote>
<div><p><strong>Reminder:</strong> a Clifford operator <span class="math notranslate nohighlight">\(C\)</span>, applied to a product of Pauliâ€™s <span class="math notranslate nohighlight">\(P\)</span>, maps it to <span class="math notranslate nohighlight">\(CPC^{\dagger}\)</span> which is again a Pauli product.</p>
</div></blockquote>
<p>During execution of a quantum circuit consisting only of Clifford gates, we only need to update the stabilizer generator Pauli strings by applying the update rule above. With our efficient encoding, this can be done very fast.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a Tableau simulator</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">TableauSimulator</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prepare GHZ state</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">measure_many</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>While it is important to understand how the Tableau works, Stimâ€™s Tableau is heavily optimized which increases itâ€™s complexity. A nice introduction on Tableau simulation is given by Aaronson and Gottesman in <a class="reference external" href="https://arxiv.org/pdf/quant-ph/0406196">â€œImproved Simulation of Stabilizer Circuitsâ€</a>.</p>
<p>For now, we are happy that we can apply gates to the Tableau and obtain correct measurements.</p>
</section>
<section id="circuit">
<h4>Circuit<a class="headerlink" href="#circuit" title="Link to this heading">#</a></h4>
<p>Stim allows us to also define quantum circuits with a API like Qiskit or Cirq. Below we create the same 3 qubit circuit preparing a GHZ state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>

<span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>We can print the circuit using the <code class="docutils literal notranslate"><span class="pre">diagram</span></code> method of <code class="docutils literal notranslate"><span class="pre">stim.Circuit</span></code>.</p>
<p>There are different options to print the circuit:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">timeline-text</span></code>: ASCII diagram</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timeline-svg</span></code>: SVG image</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timeline-svg-html</span></code>: Resizable SVG image</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timeline-3d-html</span></code>: A 3d model, in GLTF format embedded in HTML</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timeslice-svg</span></code>: Prints circuit between â€œTICKâ€ operations (more on that later)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">diagram</span><span class="p">(</span><span class="s2">&quot;timeline-text&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can sample from the circuit by compiling a sampler</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sampler</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compile_sampler</span><span class="p">()</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">shots</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>As expected roughly half of our measurements are <span class="math notranslate nohighlight">\(00\)</span> and the other half is <span class="math notranslate nohighlight">\(11\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samples</span>
</pre></div>
</div>
</div>
</div>
<p>We can also execute the circuit with a Tableau simulator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reset all qubits</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># All measurements are stored in the measurement record of the Tableau simulator</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">current_measurement_record</span><span class="p">()[</span><span class="o">-</span><span class="mi">3</span><span class="p">::]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="logical-operators-of-the-steane-code">
<h3>Logical Operators of the Steane Code<a class="headerlink" href="#logical-operators-of-the-steane-code" title="Link to this heading">#</a></h3>
<p>The Steane code has exactly 6 stabilizer generators, imposing independent constraints on the logical qubit state:
$<span class="math notranslate nohighlight">\(S|\psi\rangle = |\psi\rangle \;\;\; \forall S \in S_X \cup S_Z\)</span>$</p>
<p>Intuitively, this means that for <span class="math notranslate nohighlight">\(7\)</span> qubits we have <strong>1 degree of freedom</strong> left, meaning that the Steane code encodes a single logical qubit.</p>
<blockquote>
<div><p>It can be <a class="reference external" href="https://arthurpesah.me/blog/2023-03-16-stabilizer-formalism-2/">shown</a>, that for <span class="math notranslate nohighlight">\(m\)</span> stabilizers and <span class="math notranslate nohighlight">\(n\)</span> qubits, the number of logical qubits is <span class="math notranslate nohighlight">\(k = n - m\)</span>.</p>
</div></blockquote>
<p>Assuming, that we have found a logical operator <span class="math notranslate nohighlight">\(O_L\)</span>, then applying it to the logical qubit should result in another valid code state.
We can express this condition as:</p>
<div class="math notranslate nohighlight">
\[O_L\ket{\psi} = O_LS\ket{\psi} = \ket{\psi}\]</div>
<p>Therefore <span class="math notranslate nohighlight">\(O_LS\)</span> must be a stabilizer and the following must hold</p>
<div class="math notranslate nohighlight">
\[O_LSO_L^{\dagger} = \hat{S} \in S_X \cup S_Z\]</div>
<p>As a reminder, the stabilizer generators for the Steane code are
$<span class="math notranslate nohighlight">\(S_X = \langle X_1X_2X_3X_4, X_2X_3X_5X_6, X_3X_4X_6X_7 \rangle\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(S_Z = \langle Z_1Z_2Z_3Z_4, Z_2Z_3Z_5Z_6, Z_3Z_4Z_6Z_7 \rangle\)</span>$</p>
<p>We can see that the operators</p>
<div class="math notranslate nohighlight">
\[X_L = X_5X_6X_7 \;\;\;\; Z_L = Z_5Z_6Z_7\]</div>
<p>satisfy the conditions above. We have found logical <span class="math notranslate nohighlight">\(X_L\)</span> and <span class="math notranslate nohighlight">\(Z_L\)</span> operators!</p>
<blockquote>
<div><p><strong>Note:</strong> Although it is custom to denote the Pauli string containing Pauli-<span class="math notranslate nohighlight">\(Z\)</span> as <span class="math notranslate nohighlight">\(Z_L\)</span>, the naming is completely arbitrary. We only care about the algebraic properties of the operators.</p>
</div></blockquote>
<section id="exercise-2">
<h4>Exercise 2<a class="headerlink" href="#exercise-2" title="Link to this heading">#</a></h4>
<p><strong>(a)</strong> Verify in Stim, that the logical operators map the set of generators to itself and that <span class="math notranslate nohighlight">\(X_L\)</span> and <span class="math notranslate nohighlight">\(Z_L\)</span> anti-commute.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">stim</span><span class="w"> </span><span class="kn">import</span> <span class="n">PauliString</span>

<span class="n">steane_stabilizer</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">PauliString</span><span class="p">(</span><span class="s2">&quot;XXXXIII&quot;</span><span class="p">),</span>
    <span class="n">PauliString</span><span class="p">(</span><span class="s2">&quot;IXXIXXI&quot;</span><span class="p">),</span>
    <span class="n">PauliString</span><span class="p">(</span><span class="s2">&quot;IIIXXXX&quot;</span><span class="p">),</span>
    <span class="n">PauliString</span><span class="p">(</span><span class="s2">&quot;ZZZZIII&quot;</span><span class="p">),</span>
    <span class="n">PauliString</span><span class="p">(</span><span class="s2">&quot;IZZIZZI&quot;</span><span class="p">),</span>
    <span class="n">PauliString</span><span class="p">(</span><span class="s2">&quot;IIIZZZZ&quot;</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">log_x</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># TODO</span>
<span class="n">log_z</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># TODO</span>

<span class="c1"># Conjugate the stabilizers one by one with the logical observables and compare the lists</span>
<span class="n">conj_log_x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">conj_log_z</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">display</span><span class="p">(</span><span class="n">conj_log_x</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">conj_log_z</span><span class="p">)</span>

<span class="c1"># Logical operators anti-commute</span>
<span class="c1"># TODO</span>
</pre></div>
</div>
</div>
</div>
<p><strong>(b)</strong> Applying a stabilizer to a logical qubit does not change its state. This means that logical observables form equivalence classes modulus the stabilizers. Use Stim to find equivalent logical observables</p>
<p><img alt="Steane Logical Co-Sets" src="../../../_images/steane-code-logical-cosets.png" /></p>
<p>Source: <a class="reference external" href="https://arthurpesah.me/blog/2023-01-31-stabilizer-formalism-1/">Arthur Pesahâ€™s blog post on the stabilizer formalism</a>.</p>
<p><strong>(c) - Pen &amp; Paper</strong>
The Steane code is a CSS code, meaning that logical Clifford gates can be performed <em>transversally</em>. Verify that <span class="math notranslate nohighlight">\(H_L = H^{\otimes 7}\)</span> is a logical operator. Then show that it correspond to a logical Hadamard based on how it acts on <span class="math notranslate nohighlight">\(X_L\)</span> and <span class="math notranslate nohighlight">\(Z_L\)</span>.</p>
<blockquote>
<div><p><strong>Note:</strong> In the same manner it can be shown that <span class="math notranslate nohighlight">\(S_L = S^{\otimes 7}\)</span> implement the logical <span class="math notranslate nohighlight">\(S_L\)</span> operator.</p>
</div></blockquote>
</section>
</section>
</section>
<section id="quantum-computing-with-logical-qubits">
<h2>Quantum Computing with Logical Qubits<a class="headerlink" href="#quantum-computing-with-logical-qubits" title="Link to this heading">#</a></h2>
<section id="state-initialization">
<h3>State Initialization<a class="headerlink" href="#state-initialization" title="Link to this heading">#</a></h3>
<p>Quantum circuits usually expect their qubits to be initialized in state <span class="math notranslate nohighlight">\(\ket{0}\)</span>. Unfortunately, <span class="math notranslate nohighlight">\(\ket{0000000}\)</span> is not a valid code state.</p>
<blockquote>
<div><p><strong>Question</strong>: Which stabilizers do not stabilize this state?</p>
</div></blockquote>
<p>Therefore, an important, but usually costly, part of QEC is the logical qubit initialization. A naive approach is to prepare the physical qubits in state <span class="math notranslate nohighlight">\(\ket{0}\)</span> and measure all stabilizers.</p>
<blockquote>
<div><p><strong>Question:</strong> How many entangling gates are needed to measure all stabilizers of the Steane code naively in sequence?</p>
</div></blockquote>
<p>To allow for fault-tolerant preparation of the logical qubit, avoiding spreading of errors due to entangling gates, various efficient schemes have been developed.</p>
<p>In the following we provide code for a scheme proposed by <a class="reference external" href="https://www.nature.com/articles/srep19578">Goto</a>.</p>
<p>The scheme requires 8 CNOT gates to prepare the state, followed by a measurement of <span class="math notranslate nohighlight">\(Z_L\)</span> via 3 CNOT gates using an ancilla qubit. If the measured ancilla is in the state <span class="math notranslate nohighlight">\(|0\rangle\)</span> then we succesfully prepared the state <span class="math notranslate nohighlight">\(|0\rangle_L\)</span>, otherwise we reset all qubits and repeat the procedure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">encoding_circuit</span><span class="p">(</span><span class="n">log_qb_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Encoding scheme proposed by Goto 2015:</span>
<span class="sd">        https://www.nature.com/articles/srep19578</span>

<span class="sd">    To prepare the logical Steane qubit in state |0&gt;_L.</span>
<span class="sd">    The qubit index allows shifting the indices so that</span>
<span class="sd">    we can prepare multiple logical qubits.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
    <span class="c1"># shift registers to target logical qubit with given index</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">log_qb_idx</span> <span class="o">*</span> <span class="mi">8</span>

    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="p">,</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">s</span><span class="p">,</span> <span class="mi">6</span> <span class="o">+</span> <span class="n">s</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">s</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span> <span class="o">+</span> <span class="n">s</span><span class="p">,</span> <span class="mi">5</span> <span class="o">+</span> <span class="n">s</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span> <span class="o">+</span> <span class="n">s</span><span class="p">,</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">s</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span> <span class="o">+</span> <span class="n">s</span><span class="p">,</span> <span class="mi">5</span> <span class="o">+</span> <span class="n">s</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span> <span class="o">+</span> <span class="n">s</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">s</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span> <span class="o">+</span> <span class="n">s</span><span class="p">,</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">s</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span> <span class="o">+</span> <span class="n">s</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">s</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span> <span class="o">+</span> <span class="n">s</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">s</span><span class="p">])</span>

    <span class="c1"># Entangle with ancilla qubit and measure logical Pauli-Z</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span> <span class="o">+</span> <span class="n">s</span><span class="p">,</span> <span class="mi">7</span> <span class="o">+</span> <span class="n">s</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span> <span class="o">+</span> <span class="n">s</span><span class="p">,</span> <span class="mi">7</span> <span class="o">+</span> <span class="n">s</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span> <span class="o">+</span> <span class="n">s</span><span class="p">,</span> <span class="mi">7</span> <span class="o">+</span> <span class="n">s</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span> <span class="o">+</span> <span class="n">s</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">c</span>
</pre></div>
</div>
</div>
</div>
<p>The encoding circuit can be visualized in Stim by printing the <code class="docutils literal notranslate"><span class="pre">diagram</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">encoding_circuit</span><span class="p">()</span>
<span class="n">c</span><span class="o">.</span><span class="n">diagram</span><span class="p">(</span><span class="s2">&quot;timeline-svg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Given the encoding scheme, we should verify if it actually prepares a state with the correct stabilizers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">to_tableau</span><span class="p">(</span><span class="n">ignore_measurement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Stabilizers&quot;</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">to_stabilizers</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We can see that the state prepared by the circuit is stabilized by
$<span class="math notranslate nohighlight">\(X_1X_2X_3X_4,\;\;X_2X_3X_5X_6,\;\;X_3X_4X_6X_7\)</span>$</p>
<p>What about the Pauli-<span class="math notranslate nohighlight">\(Z\)</span> stabilizers?</p>
<p>The <a class="reference external" href="https://www.nature.com/articles/srep19578">Goto scheme</a>, prepares the <span class="math notranslate nohighlight">\(|0\rangle_L\)</span> state by measuring only the <span class="math notranslate nohighlight">\(Z\)</span>-stabilizers. Since arbitrary Pauli-<span class="math notranslate nohighlight">\(Z\)</span> errors are in this case equivalent to no errors or single-qubit <span class="math notranslate nohighlight">\(Z\)</span> errors which can be corrected by the Steane code.</p>
<p>As a final sanity check, we can sample shots from the circuit and measure <span class="math notranslate nohighlight">\(Z_L\)</span>. In the absence of noise, we should prepare the state <span class="math notranslate nohighlight">\(|0\rangle_L\)</span> with 100% success rate.</p>
<p>To avoid code repetition, letâ€™s first define a method that takes a circuit, samples from it, and returns the measurements</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>


<span class="k">def</span><span class="w"> </span><span class="nf">measure_logical_qubits</span><span class="p">(</span><span class="n">log_qubit_indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">log_qubit_index</span> <span class="ow">in</span> <span class="n">log_qubit_indices</span><span class="p">:</span>
        <span class="c1"># shift index</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">log_qubit_index</span> <span class="o">*</span> <span class="mi">8</span>
        <span class="c1"># final measurement</span>
        <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">c</span>


<span class="k">def</span><span class="w"> </span><span class="nf">sample_from_circuit</span><span class="p">(</span><span class="n">c</span><span class="p">:</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">,</span> <span class="n">shots</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
    <span class="c1"># compile a sampler and sample 10 shots</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compile_sampler</span><span class="p">()</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">r</span>
</pre></div>
</div>
</div>
</div>
<section id="exercise-3">
<h4>Exercise 3<a class="headerlink" href="#exercise-3" title="Link to this heading">#</a></h4>
<p>Given the helper function above, complete the circuit above to correctly compute the logical <span class="math notranslate nohighlight">\(Z_L\)</span> measurement result given the measurements of the physical qubits.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
<span class="c1"># prepare |0&gt;_L</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">encoding_circuit</span><span class="p">()</span>
<span class="c1"># append final measurement</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">measure_logical_qubits</span><span class="p">()</span>
<span class="c1"># sample from circuit</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">sample_from_circuit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># compute Z_L observable from measurement</span>
<span class="n">logical_measurement_output</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># TODO</span>
</pre></div>
</div>
</div>
</div>
<p>Note, that the first column of <code class="docutils literal notranslate"><span class="pre">r</span></code> corresponds to the ancilla qubit measurement and not the first qubit!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Logical measurement outcome: &quot;</span><span class="p">,</span> <span class="n">logical_measurement_output</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>As there is no noise, the ancilla should always be measured in state <span class="math notranslate nohighlight">\(|0\rangle\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ancilla qubit measurement outcome: &quot;</span><span class="p">,</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="different-basis-state-preparation">
<h3>Different Basis State Preparation<a class="headerlink" href="#different-basis-state-preparation" title="Link to this heading">#</a></h3>
<p>We can prepare the state <span class="math notranslate nohighlight">\(| 0 \rangle_L\)</span> with the method above. Next, weâ€™ll want to prepare the logical qubit in different basis states</p>
<div class="math notranslate nohighlight">
\[ \{ |0\rangle_L, |1\rangle_L, |+\rangle_L, |-\rangle_L, |+i\rangle_L, |-i\rangle_L \} \]</div>
<p>This can easily be done by using the logical gates <span class="math notranslate nohighlight">\(X_L, Z_L, S_L\)</span>, and <span class="math notranslate nohighlight">\(H_L\)</span>, that we identified in the previous section.</p>
<section id="exercise-4">
<h4>Exercise 4<a class="headerlink" href="#exercise-4" title="Link to this heading">#</a></h4>
<p>Complete the lines marked with <code class="docutils literal notranslate"><span class="pre">TODO</span></code> in the function below (Always add the index shift <code class="docutils literal notranslate"><span class="pre">s</span></code> to prepare for operations on multiple logical qubits!)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">logical_single_qubit_gate</span><span class="p">(</span><span class="n">gate</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">log_qb_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Supported logical gates:</span>
<span class="sd">        - &quot;Z&quot;: Logical Z gate</span>
<span class="sd">        - &quot;X&quot;: Logical X gate</span>
<span class="sd">        - &quot;H&quot;: Logical Hadamard gate</span>
<span class="sd">        - &quot;S&quot;: Logical S (phase) gate</span>

<span class="sd">    Args:</span>
<span class="sd">        c (stim.Circuit): The stim object to append the logical gate to</span>
<span class="sd">        gate (str): The name of the logical gate to apply.</span>
<span class="sd">                    Must be one of: &quot;Z&quot;, &quot;X&quot;, &quot;H&quot;, &quot;S&quot;</span>
<span class="sd">        log_qb_idx (int, optional): Index of the logical qubit to operate on.</span>
<span class="sd">                                    Used to offset the physical qubit indices</span>
<span class="sd">                                    when working with multiple logical qubits.</span>
<span class="sd">                                    Defaults to 0.</span>
<span class="sd">                                    Each logical qubit uses 8 physical qubits</span>
<span class="sd">                                    (7 data + 1 ancilla).</span>

<span class="sd">    Returns:</span>
<span class="sd">        stim.Circuit: The modified circuit with the logical gate appended</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
    <span class="c1"># shift registers to target logical qubit with given index</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">log_qb_idx</span> <span class="o">*</span> <span class="mi">8</span>

    <span class="k">match</span> <span class="n">gate</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;Z&quot;</span><span class="p">:</span>
            <span class="c1"># TODO</span>
            <span class="k">pass</span>
        <span class="k">case</span> <span class="s2">&quot;X&quot;</span><span class="p">:</span>
            <span class="c1"># TODO</span>
            <span class="k">pass</span>
        <span class="k">case</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
            <span class="c1"># TODO</span>
            <span class="k">pass</span>
        <span class="k">case</span> <span class="s2">&quot;S&quot;</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;S_DAG&quot;</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;S_DAG&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Logical gate name &#39;</span><span class="si">{logical_gate}</span><span class="s2">&#39; undefined&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">c</span>
</pre></div>
</div>
</div>
</div>
<p>We define a helper function to prepare the logical qubit in the Eigenstate of a given Stabilizer</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">prepare_stab_eigenstate</span><span class="p">(</span><span class="n">stabilizer</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a circuit preparing the Eigenstate of a given singe-qubit stabilizer&quot;&quot;&quot;</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>

    <span class="k">match</span> <span class="n">stabilizer</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;+Z&quot;</span><span class="p">:</span>  <span class="c1"># |0&gt;</span>
            <span class="k">pass</span>
        <span class="k">case</span> <span class="s2">&quot;-Z&quot;</span><span class="p">:</span>  <span class="c1"># |1&gt;</span>
            <span class="n">c</span> <span class="o">+=</span> <span class="n">logical_single_qubit_gate</span><span class="p">(</span><span class="n">gate</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;+X&quot;</span><span class="p">:</span>  <span class="c1"># |+&gt;</span>
            <span class="n">c</span> <span class="o">+=</span> <span class="n">logical_single_qubit_gate</span><span class="p">(</span><span class="n">gate</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;-X&quot;</span><span class="p">:</span>  <span class="c1"># |-&gt;</span>
            <span class="n">c</span> <span class="o">+=</span> <span class="n">logical_single_qubit_gate</span><span class="p">(</span><span class="n">gate</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">+=</span> <span class="n">logical_single_qubit_gate</span><span class="p">(</span><span class="n">gate</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;+Y&quot;</span><span class="p">:</span>  <span class="c1"># |+i&gt;</span>
            <span class="n">c</span> <span class="o">+=</span> <span class="n">logical_single_qubit_gate</span><span class="p">(</span><span class="n">gate</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">+=</span> <span class="n">logical_single_qubit_gate</span><span class="p">(</span><span class="n">gate</span><span class="o">=</span><span class="s2">&quot;S&quot;</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;-Y&quot;</span><span class="p">:</span>  <span class="c1"># |-i&gt;</span>
            <span class="n">c</span> <span class="o">+=</span> <span class="n">logical_single_qubit_gate</span><span class="p">(</span><span class="n">gate</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">+=</span> <span class="n">logical_single_qubit_gate</span><span class="p">(</span><span class="n">gate</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">+=</span> <span class="n">logical_single_qubit_gate</span><span class="p">(</span><span class="n">gate</span><span class="o">=</span><span class="s2">&quot;S&quot;</span><span class="p">)</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown stabilizer </span><span class="si">{</span><span class="n">stabilizer</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">c</span>
</pre></div>
</div>
</div>
</div>
<p>Letâ€™s test the state preparation for our logical qubit when measuring in the <span class="math notranslate nohighlight">\(Z_L\)</span> basis</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
<span class="c1"># prepare |0&gt;_L</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">encoding_circuit</span><span class="p">()</span>
<span class="c1"># apply a bit-flip</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">logical_single_qubit_gate</span><span class="p">(</span><span class="n">gate</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="c1"># append final measurement</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">measure_logical_qubits</span><span class="p">()</span>
<span class="c1"># sample from circuit</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">sample_from_circuit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">logical_measurement_output</span> <span class="o">=</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">7</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Logical bit-flip measurement outcome: &quot;</span><span class="p">,</span> <span class="n">logical_measurement_output</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
<span class="c1"># prepare |0&gt;_L</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">encoding_circuit</span><span class="p">()</span>
<span class="c1"># apply a logical Hadamard gate</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">prepare_stab_eigenstate</span><span class="p">(</span><span class="s2">&quot;-Z&quot;</span><span class="p">)</span>
<span class="c1"># append final measurement</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">measure_logical_qubits</span><span class="p">()</span>
<span class="c1"># sample from circuit</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">sample_from_circuit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># compute Z_L observable from measurement</span>
<span class="n">logical_measurement_output</span> <span class="o">=</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">7</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Logical Hadamard measurement outcome: &quot;</span><span class="p">,</span> <span class="n">logical_measurement_output</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
<span class="c1"># prepare |0&gt;_L</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">encoding_circuit</span><span class="p">()</span>
<span class="c1"># apply a logical X by using logical HZH construction</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">logical_single_qubit_gate</span><span class="p">(</span><span class="n">gate</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">logical_single_qubit_gate</span><span class="p">(</span><span class="n">gate</span><span class="o">=</span><span class="s2">&quot;Z&quot;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">logical_single_qubit_gate</span><span class="p">(</span><span class="n">gate</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
<span class="c1"># append final measurement</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">measure_logical_qubits</span><span class="p">()</span>
<span class="c1"># sample from circuit</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">sample_from_circuit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># compute Z_L observable from measurement</span>
<span class="n">logical_measurement_output</span> <span class="o">=</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">7</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Logical bit-flip measurement outcome: &quot;</span><span class="p">,</span> <span class="n">logical_measurement_output</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Based on the results above, we can see that logical operators works as expected and that we prepare any state that we interested in.</p>
</section>
</section>
<section id="measuring-in-different-basis">
<h3>Measuring in different Basis<a class="headerlink" href="#measuring-in-different-basis" title="Link to this heading">#</a></h3>
<p>To measure a qubit in a different basis we usually apply single-qubit rotations before the measurement in the <span class="math notranslate nohighlight">\(Z\)</span>-basis.</p>
<p>For example, if we want to measure in the <span class="math notranslate nohighlight">\(X\)</span>-basis we need to apply a Hadamard gate before the measurement since</p>
<div class="math notranslate nohighlight">
\[\langle \psi | H Z H | \psi \rangle = \langle \psi | X | \psi \rangle \]</div>
<section id="exercise-5">
<h4>Exercise 5<a class="headerlink" href="#exercise-5" title="Link to this heading">#</a></h4>
<p>Complete the lines marked with <code class="docutils literal notranslate"><span class="pre">TODO</span></code> in the function below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">rotate_to_measurement_basis</span><span class="p">(</span><span class="n">meas_basis</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Appends single-qubit rotations to a circuit to prepare</span>
<span class="sd">    measurement in specified basis&quot;&quot;&quot;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>

    <span class="k">match</span> <span class="n">meas_basis</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;Z&quot;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">case</span> <span class="s2">&quot;X&quot;</span><span class="p">:</span>
            <span class="c1"># TODO</span>
            <span class="k">pass</span>
        <span class="k">case</span> <span class="s2">&quot;Y&quot;</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">+=</span> <span class="n">logical_single_qubit_gate</span><span class="p">(</span><span class="n">gate</span><span class="o">=</span><span class="s2">&quot;S_DAG&quot;</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">+=</span> <span class="n">logical_single_qubit_gate</span><span class="p">(</span><span class="n">gate</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Specified target basis not known&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">c</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
<span class="c1"># prepare |0&gt;_L</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">encoding_circuit</span><span class="p">()</span>
<span class="c1"># rotate to X-basis</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">rotate_to_measurement_basis</span><span class="p">(</span><span class="n">meas_basis</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="c1"># append final measurement</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">measure_logical_qubits</span><span class="p">()</span>
<span class="c1"># sample from circuit</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">sample_from_circuit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># compute Z_L observable from measurement</span>
<span class="n">logical_measurement_output</span> <span class="o">=</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">7</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Logical bit-flip measurement outcome: &quot;</span><span class="p">,</span> <span class="n">logical_measurement_output</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="transversal-gates">
<h3>Transversal gates<a class="headerlink" href="#transversal-gates" title="Link to this heading">#</a></h3>
<p>We have now a good understanding of how to manipulate a single logical qubit. To leverage quantum advantage in the future, we will also need to be able to entangle our logical qubits.</p>
<p>In this section we are going to implement a logical CNOT gate. Then, weâ€™ll put everything together to prepare a logical GHZ state using 14 + 2 physical qubits:
$<span class="math notranslate nohighlight">\(\ket{GHZ}_L = \frac{1}{\sqrt{2}}\left(\ket{00}_L + \ket{11}_L\right)\)</span>$</p>
<p>In a first step, we prepare the state <span class="math notranslate nohighlight">\(|0\rangle_L \otimes |0\rangle_L\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># prepare |0&gt;_L x |0&gt;_L</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">encoding_circuit</span><span class="p">(</span><span class="n">log_qb_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">encoding_circuit</span><span class="p">(</span><span class="n">log_qb_idx</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">diagram</span><span class="p">(</span><span class="s2">&quot;timeline-svg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="logical-cnot-implementation">
<h4>Logical CNOT Implementation<a class="headerlink" href="#logical-cnot-implementation" title="Link to this heading">#</a></h4>
<p>As shown in the lecture, CSS codes allow for transversal implementation of logical entangling gates such as the logical CNOT gate.
In the Steane code the logical transversal CNOT gate is simply the pairwise CNOT between physical qubits at the same index of their respective logical qubit.</p>
<p>Letâ€™s write a method that implements the logical CNOT:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">logical_cnot</span><span class="p">(</span><span class="n">ctrl_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">target_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Implement a transversal CNOT by applying CNOT between physical</span>
<span class="sd">    qubits of the logical qubits&quot;&quot;&quot;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ctrl_idx</span> <span class="o">==</span> <span class="n">target_idx</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Control index cannot be equal target index&quot;</span><span class="p">)</span>

    <span class="n">offset_ctrl</span> <span class="o">=</span> <span class="n">ctrl_idx</span> <span class="o">*</span> <span class="mi">8</span>
    <span class="n">offset_target</span> <span class="o">=</span> <span class="n">target_idx</span> <span class="o">*</span> <span class="mi">8</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">offset_ctrl</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">offset_target</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">c</span>
</pre></div>
</div>
</div>
</div>
<p>Before applying the logical CNOT, we flip the control logical qubit to be able to test our gate</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">+=</span> <span class="n">logical_single_qubit_gate</span><span class="p">(</span><span class="n">gate</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">+=</span> <span class="n">logical_cnot</span><span class="p">(</span><span class="n">ctrl_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">target_idx</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">+=</span> <span class="n">measure_logical_qubits</span><span class="p">(</span><span class="n">log_qubit_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">c</span><span class="o">.</span><span class="n">diagram</span><span class="p">(</span><span class="s2">&quot;timeline-svg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">sample_from_circuit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logical_measurement_output_qb1</span> <span class="o">=</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">7</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">8</span><span class="p">]</span>
<span class="n">logical_measurement_output_qb2</span> <span class="o">=</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">7</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">7</span> <span class="o">+</span> <span class="mi">7</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">8</span> <span class="o">+</span> <span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">logical_measurement_output_qb1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">logical_measurement_output_qb2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="logical-bell-state">
<h3>Logical Bell State<a class="headerlink" href="#logical-bell-state" title="Link to this heading">#</a></h3>
<p>Now, we have all tools to implement a logical Bell state!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># prepare |0&gt;_L x |0&gt;_L</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">encoding_circuit</span><span class="p">(</span><span class="n">log_qb_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">encoding_circuit</span><span class="p">(</span><span class="n">log_qb_idx</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Apply Hadamard to first qubit</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">logical_single_qubit_gate</span><span class="p">(</span><span class="n">gate</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="n">log_qb_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># Apply logical CNOT</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">logical_cnot</span><span class="p">(</span><span class="n">ctrl_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">target_idx</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Add final measurements</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">measure_logical_qubits</span><span class="p">(</span><span class="n">log_qubit_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Optionally display the circuit</span>
<span class="n">c</span><span class="o">.</span><span class="n">diagram</span><span class="p">(</span><span class="s2">&quot;timeline-svg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sample and extract states</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">sample_from_circuit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">logical_measurement_output_qb1</span> <span class="o">=</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">7</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">8</span><span class="p">]</span>
<span class="n">logical_measurement_output_qb2</span> <span class="o">=</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">7</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">7</span> <span class="o">+</span> <span class="mi">7</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">8</span> <span class="o">+</span> <span class="mi">7</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">logical_measurement_output_qb1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">logical_measurement_output_qb2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="optional-simulating-the-steane-code-on-noisy-hardware-quantinuum-experiment">
<h2>Optional: Simulating the Steane Code on noisy Hardware: Quantinuum Experiment<a class="headerlink" href="#optional-simulating-the-steane-code-on-noisy-hardware-quantinuum-experiment" title="Link to this heading">#</a></h2>
<p>The Steane code has been realized in various experiments:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.science.org/doi/10.1126/science.1253742">Quantum computations on a topologically encoded qubit</a>, 2014, Nigg et al.</p></li>
<li><p><a class="reference external" href="https://journals.aps.org/prx/abstract/10.1103/PhysRevX.11.041058">Realization of Real-Time Fault-Tolerant Quantum Error Correction</a>, 2021</p></li>
<li><p><a class="reference external" href="https://arxiv.org/html/2404.02280v1">Demonstration of logical qubits and repeated error correction with better-than-physical error rates</a>, 2024</p></li>
</ul>
<p>In the following, we provide code to simulate parts of the experiment by Quantinuum in 2021, where they implemented a single logical qubit on their ion-trap device and applied multiple rounds of error correction to it.</p>
<p>This will hopefully give you a better understanding of how rounds of quantum error correction are actually implemented and how errors are handled. Please refer to the paper to learn more about the details of the experiment. Happy exploring!</p>
<section id="introducing-errors">
<h3>Introducing Errors<a class="headerlink" href="#introducing-errors" title="Link to this heading">#</a></h3>
<section id="quantinuum-error-parameters">
<h4>Quantinuum error parameters<a class="headerlink" href="#quantinuum-error-parameters" title="Link to this heading">#</a></h4>
<p>In their experiment, Quantinuum measured various error sources for their ion-trap device.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Operation</p></th>
<th class="head"><p>Error Channel</p></th>
<th class="head"><p>Probability</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Initilization</p></td>
<td><p>Bit flip</p></td>
<td><p><span class="math notranslate nohighlight">\(1.66 \cdot 10^{-6}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Measurement</p></td>
<td><p>Bit flip</p></td>
<td><p><span class="math notranslate nohighlight">\(2.4 \cdot  10^{-3}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Single-qubit gate</p></td>
<td><p>Depolarizing</p></td>
<td><p><span class="math notranslate nohighlight">\(7 \cdot 10^{-5}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Two-qubit gate</p></td>
<td><p>Depolarizing</p></td>
<td><p><span class="math notranslate nohighlight">\(3.1 \cdot 10^{-3}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Note:</strong> We excluded non-Pauli channels, such as leakage, as they cannot be handled by Stim.</p>
<p>Below, we define a helper function that allows us to inject the noise defined in the paper into our circuits:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">NoiseModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Applies noise to quantum circuits.</span>

<span class="sd">    Adds depolarizing noise after 1 and 2-qubit gates, measurement errors,</span>
<span class="sd">    and initialization errors based on typical superconducting qubit parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_error</span> <span class="o">=</span> <span class="mf">1.66</span> <span class="o">*</span> <span class="mf">1e-6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meas_error</span> <span class="o">=</span> <span class="mf">2.4</span> <span class="o">*</span> <span class="mf">1e-3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depolarize1</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">*</span> <span class="mf">1e-5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depolarize2</span> <span class="o">=</span> <span class="mf">3.1</span> <span class="o">*</span> <span class="mf">1e-3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">enabled</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">c</span>

        <span class="n">cn</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">op</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;CX&quot;</span><span class="p">:</span>
                <span class="n">cn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="s2">&quot;S_DAG&quot;</span><span class="p">]:</span>
                    <span class="n">cn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;DEPOLARIZE1&quot;</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">targets_copy</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">depolarize1</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;M&quot;</span><span class="p">:</span>
                    <span class="n">cn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;X_ERROR&quot;</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">targets_copy</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas_error</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;R&quot;</span><span class="p">:</span>
                    <span class="n">cn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;X_ERROR&quot;</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">targets_copy</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_error</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">targets</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">targets_copy</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
                    <span class="n">control</span> <span class="o">=</span> <span class="n">targets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">target</span> <span class="o">=</span> <span class="n">targets</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">cn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CX&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">control</span><span class="p">,</span> <span class="n">target</span><span class="p">])</span>
                    <span class="n">cn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;DEPOLARIZE2&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">control</span><span class="p">,</span> <span class="n">target</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">depolarize2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cn</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">noise</span> <span class="o">=</span> <span class="n">NoiseModel</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="faulty-logical-state-preparation">
<h3>Faulty logical state preparation<a class="headerlink" href="#faulty-logical-state-preparation" title="Link to this heading">#</a></h3>
<p>To test our noise model, we apply it to the Goto scheme. We expect to see some state preparation failures.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
<span class="c1"># prepare |0&gt;_L</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">noise</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">encoding_circuit</span><span class="p">())</span>
<span class="c1"># append final measurement</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">measure_logical_qubits</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">diagram</span><span class="p">(</span><span class="s2">&quot;timeline-svg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_shots</span> <span class="o">=</span> <span class="mi">100_000</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">sample_from_circuit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">num_shots</span><span class="p">)</span>

<span class="c1"># compute Z_L observable from measurement</span>
<span class="n">logical_measurement_output</span> <span class="o">=</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Measure how often the ancilla qubit is measured in state |0&gt;</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success rate: &quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">num_shots</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="syndrome-extraction">
<h3>Syndrome extraction<a class="headerlink" href="#syndrome-extraction" title="Link to this heading">#</a></h3>
<p>After succesful state preparation, the logical qubit is idling and the physical qubits will accumulate errors. This will cuase the logical qubit to decohere if we donâ€™t measure the stabilizers, effectively <strong>digitizing the noise</strong>, and tracking the changes in stabilizer measurements!</p>
<p>Below we first provide a function to measure all stabilizers of the code in a sequence.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">measure_all_syndromes</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Appends a circuit that measures all 6 stabilizers of the [[7,1,3]]-Steane code&quot;&quot;&quot;</span>

    <span class="c1"># indices for X-/Z-stabilizers</span>
    <span class="n">syndrome_qubits</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>  <span class="c1"># 1st plaquette</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>  <span class="c1"># 2nd plaquette</span>
        <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>  <span class="c1"># 3rd plaquette</span>
    <span class="p">]</span>
    <span class="c1"># indices for ancilla qubits</span>
    <span class="n">ancilla_qubits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
    <span class="c1"># measure X-stabilizers</span>
    <span class="k">for</span> <span class="n">ancilla</span><span class="p">,</span> <span class="n">data_qubits</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ancilla_qubits</span><span class="p">,</span> <span class="n">syndrome_qubits</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">data_qubits</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">data</span><span class="p">,</span> <span class="n">ancilla</span><span class="p">])</span>
        <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="n">ancilla</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="n">ancilla</span><span class="p">)</span>

    <span class="c1"># measure Z-stabilizers</span>
    <span class="k">for</span> <span class="n">ancilla</span><span class="p">,</span> <span class="n">data_qubits</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ancilla_qubits</span><span class="p">,</span> <span class="n">syndrome_qubits</span><span class="p">):</span>
        <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="n">ancilla</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">data_qubits</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">ancilla</span><span class="p">,</span> <span class="n">data</span><span class="p">])</span>
        <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="n">ancilla</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="n">ancilla</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="n">ancilla</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">c</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
<span class="n">c</span> <span class="o">+=</span> <span class="n">measure_all_syndromes</span><span class="p">()</span>
<span class="n">c</span><span class="o">.</span><span class="n">diagram</span><span class="p">(</span><span class="s2">&quot;timeline-svg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This approach for syndrome extraction is problematic as it is clearly not fault-tolerant. For example, consider a <span class="math notranslate nohighlight">\(Z\)</span> error on one of the ancilla qubits. A single error can spread to 4 physical qubits during a single stabilizer measurement!</p>
<p><strong>Can we do better?</strong></p>
<p>A first approach could be to group the entangling gates, so that we measure the stabilizers in parallel. We can measure at most 3 stabilizers in parallel. This also reduces the time the physical qubits spent idling.</p>
<p>Furthermore, we need to consider the spreading of errors from the ancillas, so called <strong>hook errors</strong>. Since the Steane code is a distance <span class="math notranslate nohighlight">\(d=3\)</span> code, we can at most correct a single error and detect two errors.</p>
<p>A simple approach to detect hook errors is to add additional â€œflagâ€ qubits, which measure parity checks on subsets of ancillas. In the following, we define circuits where the ancillas act themselves as flags for hook errors without the need for additional ancillas (Syndrome qubits reciprocally flag each other).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">measure_flagged_syndromes_xzz</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts flagged syndrome measurements for stabilizers 1, 5, 6</span>

<span class="sd">    1: XXXXIII  (Z errors on first plaquette)</span>
<span class="sd">    5: IZZIZZI  (X errors on second plaquette)</span>
<span class="sd">    6: IIZZIZZ  (X errors on third plaquette)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
    <span class="c1"># correlate</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
    <span class="c1"># correlate</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

    <span class="c1"># measure ancillas and reset them</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">c</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xzz</span> <span class="o">=</span> <span class="n">measure_flagged_syndromes_xzz</span><span class="p">()</span>
<span class="n">xzz</span><span class="o">.</span><span class="n">diagram</span><span class="p">(</span><span class="s2">&quot;timeline-svg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">measure_flagged_syndromes_zxx</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts flagged syndrome measurements for stabilizers 2, 3, 4</span>

<span class="sd">    2: ZZZZIII  (X errors on first plaquette)</span>
<span class="sd">    3: IXXIXXI  (Z errors on second plaquette)</span>
<span class="sd">    4: IIXXIXX  (Z errors on third plaquette)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>

    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
    <span class="c1"># correlate</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
    <span class="c1"># correlate</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CNOT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>

    <span class="c1"># measure ancillas and reset them</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">c</span>
</pre></div>
</div>
</div>
</div>
<p>An example of hook errors with flags is shown in the picture below, taken from the Quantinuum paper:</p>
<p><img alt="Steane Hook Errors" src="../../../_images/quantinuum-steane-hook-errors.png" /></p>
</section>
<section id="full-qec-cycle">
<h3>Full QEC cycle<a class="headerlink" href="#full-qec-cycle" title="Link to this heading">#</a></h3>
<p>We are nearly ready to run our full QEC cycle. We can now come up with a protocol to reliably correct a single physical qubit error. Our flagged syndrome circuits can detect hook errors. To differentiate them from heigher weight Pauli errors, we combine flagged and unflagged syndrome extraction.</p>
<p>If the flagged syndrome circuits do not indicate an error, than we are done and the next QEC cycle starts. Otherwise, we know that an error occurred, but we need to measure the complete set of stabilizers to identify whether a hook error occurred.</p>
<p>This combination of conditional syndrome extraction is also known as <strong>adaptive syndrome extraction</strong> and can reduce average QEC cycle time significantly.</p>
<p>The adaptive QEC cycle is depicted in the picture below:</p>
<p><img alt="" src="../../../_images/qec_cycle_with_flagged_syndromes.png" /></p>
<p>Unfortunately, Stim does not support conditional circuit execution, which means that we need to drive the <code class="docutils literal notranslate"><span class="pre">TableauSimulator</span></code> manually.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define a logger allowing us to print the progress of the execution of the QEC experiment</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-decoder">
<h3>The Decoder<a class="headerlink" href="#the-decoder" title="Link to this heading">#</a></h3>
<p>The decoder is a simple two-stage <strong>Lookup Table Decoder (LUT)</strong>. This means that for each syndrome pattern there is a fixed rule on how to update the <strong>Pauli Frame</strong>, which indicates whether the logical qubit has been flipped or not.</p>
<p>The first stage is used to decode the unflagged syndromes and the second stage decodes the flagged syndromes.</p>
<p><span class="math notranslate nohighlight">\(X\)</span>/<span class="math notranslate nohighlight">\(Z\)</span>-type errors are handled separately, but since the stabilizers have the same structure we can use the same LUT decoder.</p>
<blockquote>
<div><p><strong>Note:</strong> We donâ€™t provide the syndromes directly to the decoder but only whether the syndromes changed between QEC cycle rounds.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">unflagged_decoder</span><span class="p">(</span><span class="n">syndromes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Given X-/Z-type stabilizer measurements.</span>

<span class="sd">    The syndromes are used to infer whether a logical error has occurred</span>

<span class="sd">    This is exactly the case, when there is a change in syndromes</span>
<span class="sd">    for the 2nd/3rd stabilizer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bad_syndrome_patterns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">bad_syndrome_patterns</span> <span class="o">==</span> <span class="n">syndromes</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Unflagged decoder: Logical error detected!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>


<span class="k">def</span><span class="w"> </span><span class="nf">flagged_decoder</span><span class="p">(</span><span class="n">syndromes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">flagged_syndromes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handle hook errors.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">flagged_syndromes</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">syndromes</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]):</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">flagged_syndromes</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">syndromes</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]):</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">flagged_syndromes</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">syndromes</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]):</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>


<span class="k">def</span><span class="w"> </span><span class="nf">decoder</span><span class="p">(</span><span class="n">syndromes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">flagged_syndromes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
    <span class="n">pf</span> <span class="o">=</span> <span class="n">unflagged_decoder</span><span class="p">(</span><span class="n">syndromes</span><span class="p">)</span>
    <span class="n">pf_flag</span> <span class="o">=</span> <span class="n">flagged_decoder</span><span class="p">(</span><span class="n">syndromes</span><span class="p">,</span> <span class="n">flagged_syndromes</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pf</span><span class="p">,</span> <span class="n">pf_flag</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">qec_cycle</span><span class="p">(</span>
    <span class="n">simulator</span><span class="p">:</span> <span class="n">stim</span><span class="o">.</span><span class="n">TableauSimulator</span><span class="p">,</span>
    <span class="n">x_syndromes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
    <span class="n">z_syndromes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
    <span class="n">pauli_frame</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
    <span class="n">m_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">noise</span><span class="p">:</span> <span class="n">NoiseModel</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run a full QEC cycle for the [[7,1,3]]-Steane code</span>
<span class="sd">    by driving the Tableau simulator manually&quot;&quot;&quot;</span>

    <span class="c1"># track the delta of previous and current syndrome measurement</span>
    <span class="n">flag_diff_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>  <span class="c1"># track delta of X-stabilizers</span>
    <span class="n">flag_diff_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>  <span class="c1"># track delta of Z-stabilizers</span>

    <span class="c1"># first flagged syndrome extraction</span>
    <span class="n">simulator</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">measure_flagged_syndromes_xzz</span><span class="p">()))</span>
    <span class="c1"># measure first X-stabilizer, and second/third Z-stabilizer</span>
    <span class="n">fx0</span><span class="p">,</span> <span class="n">fz1</span><span class="p">,</span> <span class="n">fz2</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">current_measurement_record</span><span class="p">()[</span><span class="n">m_idx</span> <span class="p">:</span> <span class="n">m_idx</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span>
    <span class="c1"># update syndrome delta</span>
    <span class="n">flag_diff_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">fx0</span> <span class="o">^</span> <span class="n">x_syndromes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">flag_diff_z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">fz1</span> <span class="o">^</span> <span class="n">z_syndromes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">flag_diff_z</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">fz2</span> <span class="o">^</span> <span class="n">z_syndromes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># shift measurement index</span>
    <span class="n">m_idx</span> <span class="o">+=</span> <span class="mi">3</span>
    <span class="c1"># print delta for debugging</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Delta after 1st flagged measurement (XZZ): X </span><span class="si">{</span><span class="n">flag_diff_x</span><span class="si">}</span><span class="s2">, Z </span><span class="si">{</span><span class="n">flag_diff_z</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="c1"># if no syndrome changed continue with second round of flagged syndrome measurements</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">flag_diff_x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">flag_diff_z</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="c1"># second flagged syndrome extraction</span>
        <span class="n">simulator</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">measure_flagged_syndromes_zxx</span><span class="p">()))</span>
        <span class="c1"># measure first Z-stabilizer, and second/third X-stabilizer</span>
        <span class="n">fz0</span><span class="p">,</span> <span class="n">fx1</span><span class="p">,</span> <span class="n">fx2</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">current_measurement_record</span><span class="p">()[</span><span class="n">m_idx</span> <span class="p">:</span> <span class="n">m_idx</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span>
        <span class="c1"># update syndrome delta</span>
        <span class="n">flag_diff_z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">fz0</span> <span class="o">^</span> <span class="n">z_syndromes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">flag_diff_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">fx1</span> <span class="o">^</span> <span class="n">x_syndromes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">flag_diff_x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">fx2</span> <span class="o">^</span> <span class="n">x_syndromes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1"># shift measurement index</span>
        <span class="n">m_idx</span> <span class="o">+=</span> <span class="mi">3</span>
        <span class="c1"># print delta for debugging</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Delta after 2nd flagged measurement (ZXX): X </span><span class="si">{</span><span class="n">flag_diff_x</span><span class="si">}</span><span class="s2">, Z </span><span class="si">{</span><span class="n">flag_diff_z</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="c1"># re-measure all syndromes if flagged syndrome</span>
    <span class="c1"># extraction indicates changes in syndromes</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">flag_diff_z</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">flag_diff_x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1"># run full syndrome extraction</span>
        <span class="n">simulator</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">measure_all_syndromes</span><span class="p">()))</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">current_measurement_record</span><span class="p">()[</span><span class="n">m_idx</span> <span class="p">:</span> <span class="n">m_idx</span> <span class="o">+</span> <span class="mi">7</span><span class="p">]</span>
        <span class="c1"># update syndromes</span>
        <span class="n">current_z_syndromes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span>
        <span class="p">)</span>  <span class="c1"># First 3 measurements Z-stabilizers</span>
        <span class="n">current_x_syndromes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">::],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span>
        <span class="p">)</span>  <span class="c1"># Final 3 measurements X-stabilizers</span>
        <span class="c1"># compute delta</span>
        <span class="n">diff_x_syndromes</span> <span class="o">=</span> <span class="n">x_syndromes</span> <span class="o">^</span> <span class="n">current_x_syndromes</span>
        <span class="n">diff_z_syndromes</span> <span class="o">=</span> <span class="n">z_syndromes</span> <span class="o">^</span> <span class="n">current_z_syndromes</span>
        <span class="c1"># shift measurement index</span>
        <span class="n">m_idx</span> <span class="o">+=</span> <span class="mi">6</span>
        <span class="c1"># print new syndrome measurements</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Delta after unflagged measurement: &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;X:</span><span class="si">{</span><span class="n">diff_x_syndromes</span><span class="si">}</span><span class="s2">, Z:</span><span class="si">{</span><span class="n">diff_z_syndromes</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="c1"># call decoder to get updated pauli frame</span>
        <span class="n">pf_x</span><span class="p">,</span> <span class="n">pf_flag_x</span> <span class="o">=</span> <span class="n">decoder</span><span class="p">(</span><span class="n">diff_x_syndromes</span><span class="p">,</span> <span class="n">flag_diff_x</span><span class="p">)</span>
        <span class="n">pf_z</span><span class="p">,</span> <span class="n">pf_flag_z</span> <span class="o">=</span> <span class="n">decoder</span><span class="p">(</span><span class="n">diff_z_syndromes</span><span class="p">,</span> <span class="n">flag_diff_z</span><span class="p">)</span>

        <span class="c1"># update pauli frame</span>
        <span class="n">pauli_frame</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">pauli_frame</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">pf_x</span> <span class="o">^</span> <span class="n">pf_flag_x</span>
        <span class="n">pauli_frame</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pauli_frame</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="n">pf_z</span> <span class="o">^</span> <span class="n">pf_flag_z</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pauli frame: Z: </span><span class="si">{</span><span class="n">pauli_frame</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, X: </span><span class="si">{</span><span class="n">pauli_frame</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># update syndromes</span>
        <span class="n">x_syndromes</span> <span class="o">=</span> <span class="n">current_x_syndromes</span>
        <span class="n">z_syndromes</span> <span class="o">=</span> <span class="n">current_z_syndromes</span>

    <span class="k">return</span> <span class="n">simulator</span><span class="p">,</span> <span class="n">x_syndromes</span><span class="p">,</span> <span class="n">z_syndromes</span><span class="p">,</span> <span class="n">pauli_frame</span><span class="p">,</span> <span class="n">m_idx</span>
</pre></div>
</div>
</div>
</div>
<p>For the final round of quantum error correction, we measure all physical qubits simultaneously in the <span class="math notranslate nohighlight">\(Z\)</span>-basis.</p>
<p>Given the measurement results, we compute the syndrome measurements as well as the logical observable by classically XORing the bits.</p>
<p>Depending on the chosen measurement basis, we need to modify the syndromes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">destructive_logical_measurement</span><span class="p">(</span>
    <span class="n">simulator</span><span class="p">:</span> <span class="n">stim</span><span class="o">.</span><span class="n">TableauSimulator</span><span class="p">,</span>
    <span class="n">meas_basis</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">x_syndromes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
    <span class="n">z_syndromes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
    <span class="n">pauli_frame</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
    <span class="n">m_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">noise</span><span class="p">:</span> <span class="n">NoiseModel</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform final destructive measurement where all physical qubits are measured.</span>

<span class="sd">    Returns a single bit, corresponding to the logical qubit measurement in the</span>
<span class="sd">    specified measurement basis. A final set of syndromes can be computed depending</span>
<span class="sd">    on the measurement basis.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Measure all seven physical qubits of our logical qubit destructively</span>
    <span class="n">simulator</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">measure_logical_qubits</span><span class="p">()))</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">current_measurement_record</span><span class="p">()[</span><span class="n">m_idx</span> <span class="p">:</span> <span class="n">m_idx</span> <span class="o">+</span> <span class="mi">7</span><span class="p">]</span>

    <span class="c1"># Compute the logical observable</span>
    <span class="n">log_obs</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>

    <span class="c1"># Compute syndromes</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># First plaquette</span>
    <span class="n">s2</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>  <span class="c1"># Second plaquette</span>
    <span class="n">s3</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">^</span> <span class="n">r</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>  <span class="c1"># Third plaquette</span>
    <span class="n">syndromes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

    <span class="k">match</span> <span class="n">meas_basis</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;X&quot;</span><span class="p">:</span>
            <span class="n">syndrome_diff</span> <span class="o">=</span> <span class="n">syndromes</span> <span class="o">^</span> <span class="n">x_syndromes</span>
        <span class="k">case</span> <span class="s2">&quot;Y&quot;</span><span class="p">:</span>
            <span class="n">syndrome_diff</span> <span class="o">=</span> <span class="n">syndromes</span> <span class="o">^</span> <span class="n">x_syndromes</span>
            <span class="n">syndrome_diff</span> <span class="o">=</span> <span class="n">syndromes</span> <span class="o">^</span> <span class="n">z_syndromes</span>
        <span class="k">case</span> <span class="s2">&quot;Z&quot;</span><span class="p">:</span>
            <span class="n">syndrome_diff</span> <span class="o">=</span> <span class="n">syndromes</span> <span class="o">^</span> <span class="n">z_syndromes</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown measurement basis </span><span class="si">{</span><span class="n">meas_basis</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Delta final round: </span><span class="si">{</span><span class="n">syndrome_diff</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Get final corrections from the unflagged decoder</span>
    <span class="n">final_correction</span> <span class="o">=</span> <span class="n">unflagged_decoder</span><span class="p">(</span><span class="n">syndrome_diff</span><span class="p">)</span>

    <span class="c1"># Update the logical obs</span>
    <span class="n">log_obs</span> <span class="o">=</span> <span class="n">log_obs</span> <span class="o">^</span> <span class="n">final_correction</span>

    <span class="c1"># Finally, apply correction based on measurement basis</span>
    <span class="k">match</span> <span class="n">meas_basis</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;X&quot;</span><span class="p">:</span>
            <span class="n">log_obs</span> <span class="o">=</span> <span class="n">log_obs</span> <span class="o">^</span> <span class="n">pauli_frame</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">case</span> <span class="s2">&quot;Y&quot;</span><span class="p">:</span>
            <span class="n">log_obs</span> <span class="o">=</span> <span class="n">log_obs</span> <span class="o">^</span> <span class="n">pauli_frame</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">pauli_frame</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;log : </span><span class="si">%s</span><span class="s2">, pf: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">log_obs</span><span class="p">,</span> <span class="n">pauli_frame</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;Z&quot;</span><span class="p">:</span>
            <span class="n">log_obs</span> <span class="o">=</span> <span class="n">log_obs</span> <span class="o">^</span> <span class="n">pauli_frame</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">log_obs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">expected_result</span><span class="p">(</span><span class="n">measure_output</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">stabilizer</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">meas_basis</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate if measurement corresponds to the expected measurement</span>
<span class="sd">    result for a given stabilizer and measurement basis.&quot;&quot;&quot;</span>

    <span class="n">pauli_measurement</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">PauliString</span><span class="p">(</span><span class="n">meas_basis</span><span class="p">)</span>
    <span class="n">pauli_stabilizer</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">PauliString</span><span class="p">(</span><span class="n">stabilizer</span><span class="p">)</span>
    <span class="n">commute</span> <span class="o">=</span> <span class="n">pauli_stabilizer</span><span class="o">.</span><span class="n">commutes</span><span class="p">(</span><span class="n">pauli_measurement</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">commute</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Anti-commuting stabilzers, measurement is random&quot;</span><span class="p">)</span>

    <span class="n">sign</span> <span class="o">=</span> <span class="p">(</span><span class="n">pauli_measurement</span> <span class="o">*</span> <span class="n">pauli_stabilizer</span><span class="p">)</span><span class="o">.</span><span class="n">sign</span>

    <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="mi">0</span> <span class="o">==</span> <span class="n">measure_output</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span> <span class="o">==</span> <span class="n">measure_output</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we can put everything together and run the whole QEC cycle!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">steane_code_exp</span><span class="p">(</span>
    <span class="n">initial_state</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;+Z&quot;</span><span class="p">,</span>
    <span class="n">meas_basis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Z&quot;</span><span class="p">,</span>
    <span class="n">num_cycles</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">shots</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="n">noise</span><span class="o">=</span><span class="n">NoiseModel</span><span class="p">(),</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Runs an error correction experiment for the Steane [[7,1,3]]-code.</span>

<span class="sd">    The quantum state is represented by the state of the stim TableauSimulator.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">shots</span><span class="p">):</span>
        <span class="n">simulator</span> <span class="o">=</span> <span class="n">stim</span><span class="o">.</span><span class="n">TableauSimulator</span><span class="p">()</span>

        <span class="n">m_idx</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># shift measurement index</span>

        <span class="c1"># state preparation (3 attempts)</span>
        <span class="c1"># prepare the logical |0&gt;_L state and verify with ancilla</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">simulator</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">encoding_circuit</span><span class="p">()))</span>
            <span class="n">state_prep_ancilla</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">current_measurement_record</span><span class="p">()[</span><span class="n">m_idx</span><span class="p">]</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;State preparation ancilla: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">state_prep_ancilla</span><span class="p">))</span>
            <span class="n">m_idx</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">state_prep_ancilla</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="c1"># apply single qubit gate to prepare correct state</span>
        <span class="n">simulator</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">prepare_stab_eigenstate</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)))</span>

        <span class="c1"># run QEC cycles</span>
        <span class="n">x_syndromes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">z_syndromes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="c1"># Pauli frame tracks which logical correction to apply</span>
        <span class="c1"># Pauli Frame = [Apply X_L?, Apply Z_L?]</span>
        <span class="n">pauli_frame</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_cycles</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--- QEC cycle </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">simulator</span><span class="p">,</span> <span class="n">x_syndromes</span><span class="p">,</span> <span class="n">z_syndromes</span><span class="p">,</span> <span class="n">pauli_frame</span><span class="p">,</span> <span class="n">m_idx</span> <span class="o">=</span> <span class="n">qec_cycle</span><span class="p">(</span>
                <span class="n">simulator</span><span class="p">,</span> <span class="n">x_syndromes</span><span class="p">,</span> <span class="n">z_syndromes</span><span class="p">,</span> <span class="n">pauli_frame</span><span class="p">,</span> <span class="n">m_idx</span><span class="p">,</span> <span class="n">noise</span>
            <span class="p">)</span>

        <span class="c1"># Rotate to correct logical measurement basis</span>
        <span class="n">simulator</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">rotate_to_measurement_basis</span><span class="p">(</span><span class="n">meas_basis</span><span class="o">=</span><span class="n">meas_basis</span><span class="p">)))</span>

        <span class="c1"># Perform final destructive logical measurement</span>
        <span class="n">final_measurement</span> <span class="o">=</span> <span class="n">destructive_logical_measurement</span><span class="p">(</span>
            <span class="n">simulator</span><span class="p">,</span> <span class="n">meas_basis</span><span class="p">,</span> <span class="n">x_syndromes</span><span class="p">,</span> <span class="n">z_syndromes</span><span class="p">,</span> <span class="n">pauli_frame</span><span class="p">,</span> <span class="n">m_idx</span><span class="p">,</span> <span class="n">noise</span>
        <span class="p">)</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Final measurement: </span><span class="si">{</span><span class="n">final_measurement</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">success</span> <span class="o">=</span> <span class="n">expected_result</span><span class="p">(</span><span class="n">final_measurement</span><span class="p">,</span> <span class="n">initial_state</span><span class="p">,</span> <span class="n">meas_basis</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Success: </span><span class="si">{</span><span class="n">success</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment to follow QEC cycle execution</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

<span class="n">noise</span> <span class="o">=</span> <span class="n">NoiseModel</span><span class="p">()</span>
<span class="n">noise</span><span class="o">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">steane_code_exp</span><span class="p">(</span><span class="n">num_cycles</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">initial_state</span><span class="o">=</span><span class="s2">&quot;+Y&quot;</span><span class="p">,</span> <span class="n">meas_basis</span><span class="o">=</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="simulating-logical-error-rates-for-steane-code-for-each-basis">
<h3>Simulating Logical Error Rates for Steane Code for each Basis<a class="headerlink" href="#simulating-logical-error-rates-for-steane-code-for-each-basis" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shots</span> <span class="o">=</span> <span class="mi">2048</span>
<span class="n">cycles_sweep</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">basis_sweep</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">]</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">NoiseModel</span><span class="p">()</span>
<span class="n">noise</span><span class="o">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">basis</span> <span class="ow">in</span> <span class="n">basis_sweep</span><span class="p">:</span>
    <span class="n">cycle_results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">cycles</span> <span class="ow">in</span> <span class="n">cycles_sweep</span><span class="p">:</span>
        <span class="n">exp_results</span> <span class="o">=</span> <span class="n">steane_code_exp</span><span class="p">(</span>
            <span class="n">num_cycles</span><span class="o">=</span><span class="n">cycles</span><span class="p">,</span>
            <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span>
            <span class="n">initial_state</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;+</span><span class="si">{</span><span class="n">basis</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">meas_basis</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">basis</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">cycle_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">exp_results</span><span class="p">)</span> <span class="o">/</span> <span class="n">shots</span><span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cycle_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Steane Code Logical Error Rate vs. QEC cycles&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;QEC Cycles&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Logical Error Rate&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">basis</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">basis_sweep</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cycles_sweep</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="n">idx</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="n">basis</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Basis&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Notebooks</p>
      </div>
    </a>
    <a class="right-next"
       href="decoding_excercise.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tutorial - MAP Decoding Exercise</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#steane-code">Steane Code</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-construction">Code Construction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-steane-code">Visualizing the Steane Code</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#excursion-stim-and-stabilizer-formalism">Excursion: Stim and Stabilizer formalism</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pauli-strings">Pauli Strings</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tableau">Tableau</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#circuit">Circuit</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#logical-operators-of-the-steane-code">Logical Operators of the Steane Code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-computing-with-logical-qubits">Quantum Computing with Logical Qubits</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#state-initialization">State Initialization</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#different-basis-state-preparation">Different Basis State Preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#measuring-in-different-basis">Measuring in different Basis</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transversal-gates">Transversal gates</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#logical-cnot-implementation">Logical CNOT Implementation</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#logical-bell-state">Logical Bell State</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-simulating-the-steane-code-on-noisy-hardware-quantinuum-experiment">Optional: Simulating the Steane Code on noisy Hardware: Quantinuum Experiment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-errors">Introducing Errors</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#quantinuum-error-parameters">Quantinuum error parameters</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#faulty-logical-state-preparation">Faulty logical state preparation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#syndrome-extraction">Syndrome extraction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#full-qec-cycle">Full QEC cycle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-decoder">The Decoder</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-logical-error-rates-for-steane-code-for-each-basis">Simulating Logical Error Rates for Steane Code for each Basis</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By NordIQuEst
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2024, NordIQuEst.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  
    <div style="width: 100%; text-align: center; padding: 10px 0;">
        <a href="https://nordiquest.net" target="_blank">https://nordiquest.net</a>
        <hr>
        <p><strong>Funding</strong></p>
        <p>NordIQuEst is a project of the <a href="https://neic.no" target="_blank"><b>Nordic e-Infrastructure Collaboration (NeIC).</b></a>. NeIC is an organisational unit under <a href="https://www.nordforsk.org/" target="_blank"><b>NordForsk.</b></a>.</p>
        <p>Project Manager: Alberto Lanzanova (alberto.lanzanova at csc.fi)</p>
    </div>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>